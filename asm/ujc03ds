UJC03DS  TITLE '        DECODE DATA SET DECLARE'                74303   00010000
* JOL COPYRIGHT CLARKE COMPUTER SOFTWARE 1971,1972,1973,1974,1975       00020000
* COPYRIGHT CCS 1976,1980                                               00030000
* COPYRIGHT C. V. CLARKE 1982                                           00040000
* COPYRIGHT C. V. CLARKE 1983                                           00050000
* COPYRIGHT CCS-JOL P.L  1986.                                          00051000
* COPYRIGHT C. V. CLARKE 2010                                           00052007
*                                                                       00060000
* REFER TO INSTRUCTIONS ON COPYRIGHT NOTICE FORM NO CCS-C001.           00070000
           SPACE 3                                                      00080000
*                   J             000000            L                   00090000
*                   J            0      0           L                   00100000
*                   J           0        0          L                   00110000
*                   J          0          0         L                   00120000
*                   J         0            0        L                   00130000
*                   J         0            0        L                   00140000
*                   J         0            0        L                   00150000
*                   J         0            0        L                   00160000
*                   J         0            0        L                   00170000
*                   J         0            0        L                   00180000
*                   J         0            0        L                   00190000
*        J          J         0            0        L                   00200000
*         J        J           0          0         L                   00210000
*          J      J             0        0          L                   00220000
*           J    J               0      0           L                   00230000
*            JJJJ                 000000            LLLLLLLLLLL         00240000
           SPACE 3                                                      00250000
*JOL30030:-    WHEN UNIT KEYWORD USED,JOL DOESNT LOOK UP DEVNAMET       00260000
*JOL30034:-    UNITNO & UCOUNT NOT ALLOWED FOR SYSOUT FILES             00270000
*JOL30041:-    UCOUNT=P STORES UCOUNT 1                                 00280000
*JOL30048:-    JOL OVER-WRITES SYSOUT CLASS WHEN FORM USED              00290000
*JOL30053:-    FIELDS NOT MERGED WITH LIKE OVERRIDE                     00300000
*JOL30055:-    RETPD TOO SHORT                                          00310000
*                                                                       00320000
* MODIFIED BY C.V. CLARKE FOR BINARY TABLE SEARCH, JULY, 1986.          00330000
*                                                                       00371000
* MODIFIED BY C.V. CLARKE TO INCLUDE XA SUPPORT DEC, 1983               00372000
*    THIS SUPPORT REPLACES THE CODE THAT CHECKED THE DEVNAMET           00373000
*    WITH A CALL TO A NEW MODULE UJC03DEV IN SOURCE MODULE              00374000
*    UJS02XA                                                            00375000
*                                                                       00376000
* MODIFIED BY D.J.DOUBTFIRE TO INCLUDE SPECIAL PARAMETERS               00380000
* FOR LASER PRINTERS (FLASH,,CHARS,BURST,MODIFY).                       00390000
*                                                                       00400000
*                                                                       00410000
           SPACE 3                                                      00420000
         COPY JOLCOM                                                    00430000
         TITLE  'DATA SET AND SYSOUT ANALYSER - DSIDS'            75128 00440000
         PRINT DATA                                               75128 00450000
C03SAVE  DSECT                                                    75128 00460000
         DS    18F                                                75128 00470000
C03STKN  DS    H      SAVE AREA FOR CURRENT TOKEN #                DASD 00480000
C03DEXT  DS    CL1                                                75128 00490000
C03DLIKE DS    CL8                                                75128 00500000
         COPY  DDEXTRA                                                  00500100
*DWORK   DS    (600/4)F  WORK AREA FOR DDSNDET.  IT USED TO USE     J60 00500208
*                        THE 'TRANS' WORK AREA IN JOLCOM, BUT IT    J60 00500303
*                        IS TOO SMALL FOR THE PATH ETC.             J60 00500403
C03DLEN  EQU   *-C03SAVE                                                00510000
         JOLSAVE CSECT=UJC03DS,BASE=(11,12),SIZE=C03DLEN          75128 00520000
* THIS CSECT IS RESPONSIBLE FOR DECODING A DATA SET DECLARATION         00530000
*    ON ENTRY,R1 CONTAINS THE ADDRESS OF A PARM LIST WHICH CONTAINS     00540000
*    THE FOLLOWING INFORMATION:-                                        00550000
*          1. THE ADDRESS OF TKNX                                       00560000
*          2. THE ADDRESS OF JOLCOM,WHICH CONTAINS VARIOUS PIECES       00570000
*              OF INFORMATION,SUCH AS DCB'S ETC                         00580000
*          3. THE ADDRESS OF AN AREA INTO WHICH THE DECODED DECLARE     00590000
*              IS TO BE PLACED AS TABLES.                               00600000
           SPACE                                                        00610000
* LET'S ESTABLISH A BIT OF ADDRESSALITY.                                00620000
           LM  R2,R4,0(R1)     LOAD PARAMETER LIST                      00630000
           USING JOLCOM,R2                                              00640000
           USING TKNX,R3                                                00650000
           USING C03SAVE,R13                                      75128 00670000
*          LA    R4,DDWORK    CHANGED NOV 28, 2010                J60   00671008
           USING DDDSNDET,R4                                            00672004
           SPACE                                                        00680000
*        MVI   DDDSNDET,C' '                                      J60   00681008
*        MVC   DDDSNDET+1(256),DDDSNDET                           J60   00682008
*        MVC   DDDSNDET(4),ZERO                                   J60   00683008
         CLEAR C03DEXT,C03DLIKE,DDSPECTP,DDSPECT2,                75128*00690000
               DDCANCEL,DDLABEL,DDUNITNO,DDPRIM,DDSEC,DDDIRECT,   80290*00700000
               DDBLKSZE,DDLRECL,DDSIZE,DDSIZE2,DDAVREC,DDBUFNO,   80290*00710000
               DDBUFND,DDBUFNI,                                   82300*00720000
               DDBUFL,DDRKP,DDKEYLEN,DDOVERFL,DDVOLSEQ,DDMAXVOL,  80290*00730000
               DDUNITQU                                                 00740000
         CLEAR DDAEXTRA,DDLENXTR,DDLENXTR+2,#DDSUBS,#DDVOL,       87150*00741000
               DDSUBS,DDLONGVL                                    87150 00742000
           MVI DDDD1,C'D'                      SET RECORD TYPE TO'D'    00750000
           MVC DDSTMT,STMT                     MOVE STMT NO IN FOR      00760000
*                                              ERRORS LATER             00770000
           MVC DDLEVEL,LEVEL+1                                          00780000
           MVC DDNEST,NEST+1                                            00790000
           MVC DDOSVB,=AL2(DDLEN)                                       00800000
           GETTKN NO=2                         GET THE 2ND TOKEN        00810000
           MVC DDDSID,TKN                      MOVE THE DSIDENTIFIER    00820000
*                                              IN                       00830000
           SPACE 3                                                      00840000
* NOW THE HARD WORK BEGINS,I.E DECODING MADLY                           00850000
           GETTKN NO=3                                                  00860000
           CLI TKN,C'*'                        SYSIN DATA SET ?         00870000
           BNE NOTSYSIN                                                 00880000
           STH R1,TKNCURR                                               00890000
           MVC DDDSNAME(4),=C'*,$$'                                     00900000
           MVC DDDSNAME+4(4),DDSTMT                                     00910000
           OC  DDDSNAME+4(4),=C'0000'                                   00920000
         MVI   DDTYPE,DDSYSIN                                     75128 00930000
           B C                                 SEE IF ANY OTHER INFO    00940000
           SPACE 3                                                      00950000
NOTSYSIN   EQU *                                                        00960000
* NOW TRY SYSOUT PROCESSING                                             00970000
           CLC TKN(6),=C'SYSOUT'                                        00980000
           BE ISSYSOUT                                                  00990000
           CLC =C'PRINTER',TKN                                          01000000
           BE ISSYSOUT                                                  01010000
           CLC =C'PUNCH ',TKN                                           01020000
           BNE NOSYSOUT                                                 01030000
*   PUNCH DATA SET HERE                                                 01040000
          CLEAR DDCOPIES,DDOUTLIM                                 75128 01050000
         MVI   DDTYPE,DDPUNCH TURN ON PUNCH INDICATOR             75128 01060000
           L   R1,AJOLGEN                                         75311 01070000
           USING GENDETS,R1                                       75311 01080000
           MVC DDSYSCLS,PUNCHCLS                                  75311 01090000
           DROP R1                                                75311 01100000
           MVI TKNCURR+1,4     SET TKNCURR=4 (MVI OK)             74256 01110000
           B   C               START NORMAL PROCESSING                  01120000
ISSYSOUT    EQU *                                                       01130000
         CLEAR DDCOPIES,DDOUTLIM,                                 75311*01140000
               DDFLASH,DDCHARS,DDMODIFY,DDBURST                   75311 01150000
           MVI TKNCURR+1,4     SET TKNCURR=4 (MVI OK)             74256 01160000
         MVI   DDTYPE,DDSYSOUT TURN ON SYSOUT INDICATOR           75128 01170000
           GETTKN NO=4                                                  01180000
           CLI TKN,C'='                        SYSOUT=?                 01190000
           BNE NOSYSEQU                                                 01200000
           STH R1,TKNCURR                                               01210000
           GETTKN (R1)         GET SYMBOL AFTER '='               74256 01220000
           CLC TKN,C' '        USER MAY HAVE CODED ' 'ACCIDENTLY  74256 01230000
           BE  C               IF SO,DON'T UPSET DEFAULT CLASS 'A'74256 01240000
C03STRCL CLI   TKN,C'''' SYSOUT='(A,X,C)' ????                    75128 01250000
         BNE   C03SYSNS       NOT SPECIAL SYSOUT                  75128 01260000
         MVI   DDTYPE,DDSPECOU TURN ON SPECIAL SYSOUT PROCESSING  75128 01270000
         XC    DDDSNAME(L'DDDSNAME+L'DDMBR),DDDSNAME SO NOTHING   75128 01280000
*                                  ELSE CAN BE STORED 'JOLSTOR'   75128 01290000
           BAL  R14,DROPQUOT      DROP ANY QUOTES                       01300000
         LH    R15,#TKN            LOAD LENGTH                    75128 01310000
         LA    R15,2-1(R15)        +1                             75128 01320000
         EX    R15,SYSXMUV         SHIFT IT IN                    75128 01330000
         B     STORR1                                             75128 01340000
SYSXMUV  MVC   DDDSNAME(*-*),#TKN                                 75128 01350000
         SPACE 3                                                  75128 01360000
C03SYSNS MVC   DDDSNAME(1),TKN POP IN REQUESTED CLASS             75128 01370000
           B   STORR1          STORE R1 IN TKNCURR,CARRY ON       74256 01380000
NOSYSEQU   EQU *                                                        01390000
* HERE,WE MAY HAVE A BLANK, IE USER CODED 'DCL X PRINTER;'        74256 01400000
           CLI TKN,C' '        ' '                                74256 01410000
           BE  C               YES,GO TO END PROCESSING           74256 01420000
* NOW HERE WE COULD HAVE:-                                        74256 01430000
*    'DCL X PRINTER A';                                           74256 01440000
* OR 'DCL X PRINTER 2 PART'; ETC                                  74256 01450000
*    IF PRINTER 'A' | SYSOUT A THEN WE SHALL OVER-RIDE OUR DEFAULT74256 01460000
*          OF SYSOUT=(A)                                          74256 01470000
* HOWEVER,WE COULD ALSO HAVE 'FORM XYZ' OR'2 PART' OR '2 COPIES'  74256 01480000
* SO:- LETS SORT THAT OUT A BIT MORE                              74256 01490000
           CLI #TKN+1,1                        LENGTH OF TOKEN=1 ?      01500000
*                                              IE SYSOUT= A ?           01510000
           BNE C               GO JOIN NORMAL LOOP                74256 01520000
          FIX 'CHECK THIS MORE THOROUGHLY LATER' 80290                  01530000
         CLI   TKN,C'*'                SYSOUT = * ?              A DASD 01540000
         BNE   C03CKTYP                                          A DASD 01550000
         L     R1,AJOLGEN                                        A DASD 01560000
         USING GENDETS,R1                                        A DASD 01570000
         LA    R1,5                    NEXT TOKEN IS NO 5        A DASD 01580000
         CLC   DEFSYS(3),=CL3'VS2'     IS SYSTEM VS2 ?           A DASD 01590000
         BE    C03STRCL                SYSOUT=* & SYSTEM IS VS2  A DASD 01600000
         CLC   DEFSYS(3),=CL3'MVS'     IS SYSTEM VS2 ?            82200 01610000
         BE    C03STRCL                SYSOUT=* & SYSTEM IS VS2   82200 01620000
         DROP  R1                                                A DASD 01630000
C03CKTYP TM    TKNTYPE,X'01' ALPHABETIC OR NUMERIC ?       C63537  SOCO 01640000
         BO   C                                                         01650000
* HERE IT IS A 1 CHARACTER,ALPHABETIC TOKEN,SO SYSOUT=X           74256 01660000
           LA  R1,5            NEXT TOKEN WILL BE NO 5            74256 01670000
           B   C03STRCL        GO STORE SYSOUT CLASS              74256 01680000
           SPACE 3                                                      01690000
NOSYSOUT   EQU *                                                        01700000
* HERE IT IS NOT A SYSIN OR SYSOUT DATA-SET                             01710000
*    WE MUST SEE IF HE SAID'DCL X DS'OR'DCL X DATA SET'                 01720000
           CLC     TKN(2),=C'DS'                                        01730000
           BE  SKIP1                                                    01740000
           LA  R1,1(R1)                                                 01750000
STORR1     EQU *                                                  74256 01760000
SKIP1      STH R1,TKNCURR                                               01770000
           SPACE 3                                                      01780000
C          EQU *                                                        01790000
* WHEW,NOW WE CAN FINALLY GET INTO OUR LITTLE DECODING LOOP             01800000
*    AND QUIETLY GO BESERK                                              01810000
           CLC TKNCURR,TKNNO                   HAVE WE FINISHED ?       01820000
           BNH FINDKEY                         NO,PRESS ONWARDS         01830000
           SPACE 3                                                      01840000
* WE APPARENTLY HAVE FINISHED PROCESSING THE MIGHTY DECLARE STMT        01850000
* NOW BEFORE WE GO (AND BASICALLY BECAUSE THE TABLE IS IN CORE NOW)     01860000
*     WE WILL HAVE A DECKO AT THE UNIT AND VOLUME TO SEE IF WE CAN      01870000
*     FILL IN THE 'DDUNITYP' FIELD.                                     01880000
           IFNULL DDVOLUME,C03CANT CANT DO ANYTHING WITH THE UNIT       01890000
*                         TYPE SO LEAVE IT FOR A LATER PHASE.           01900000
           SPACE 3                                                      01910000
* NOW WE HAVE A VOLUME                                                  01920000
* LET'S SEE IF IT IS IN THE TABLE                                       01930000
         L     R1,AJOLGEN                                         75128 01940000
         USING UJGENDET,R1                                        75128 01950000
         L     R1,APREFVOL                                        75128 01960000
         DROP  R1                                                 75128 01970000
           LM R7,R9,0(R1)      LOAD BXLE CONSTANTS                      01980000
C03FV01    CLC 0(6,R7),DDVOLUME                                         01990000
           BE  C03UN01                                                  02000000
           BXLE R7,R8,C03FV01                                           02010000
           B  C03CANT          DIDN'T FIND IT IN TABLE,SO AWAY,AWAY     02020000
C03UN01    EQU *                                                        02030000
* NOW IF THE DDUNITYP FIELD IS '' THE WE'LL COPY THIS ONE IN            02040000
           CLI DDUNITYP,C' '                                            02050000
           BNE C03COMPU                                                 02060000
           MVC DDUNITYP,6(R7) SHIFT IN UNIT TYPE (JOLS)                 02070000
           B  C03CANT                                                   02080000
C03COMPU   EQU *                                                        02090000
* THE UNIT TYPE HAS BEEN SET UP.                                        02100000
*     IT COULD HAVE BEEN SET UP BY THE VOLUME PROCESSOR EQRLIER         02110000
*     OR FROM THE UNIT PROCESSOR.                                       02120000
*     BECAUSE THIS IS A PREFERRED VOLUME WE CAN AT LEAST CHECK          02130000
*     THAT THE UNIT TYPES ARE VAGUELLY SIMILIAR.                        02140000
           SR R0,R0                                                     02150000
           IC R0,6(R7)    GET UNIT TYPE FROM VOL TABLE                  02160000
           SR R1,R1                                                     02170000
           IC R1,DDUNITYP GET UNIT TYPE FROM DD CARD                    02180000
           LA R15,X'1F'   ONLY WANT TO LOOK AT LAST 5 BITS          J60 02190000
           NR R0,R15      SO AND                                        02200000
           NR R1,R15      SO AND                                        02210000
           CR R0,R1       AND COMPARE                                   02220000
           BE C03CANT     ALL'S OK                                      02230000
         JOLERR 202,'UNIT SPECIFIED FOR PREFERRED VOLUME CHANGED AS IT *02240000
               WAS INCORRECT'                                           02250000
           MVC DDUNITYP,6(R7)  OVER-WRITE THE UNIT HE SPECIFIED         02260000
C03CANT    EQU *                                                        02270000
* IF THIS IS A SYSIN CARD FILE,SHIFT IN THE DEFAULT BLOCKSIZE SO THAT   02280000
*    IF THE USER IS OVER-RIDING A DSID,THE THE BLOCKSIZE FROM THE OLD   02290000
*    ONE WON'T GET IN THE JCL.                                          02300000
           CLC =C'*,$$',DDDSNAME SYSIN ?                                02310000
           BNE C03FINDO        NO,FIND OLD ONE(IF THERE IS ONE)         02320000
* NOW SHIFT IN BLOCKSIZE AND LRECL,IF NOT THERE ALREADY                 02330000
           IFVALUE DDBLKSZE,C03LSYSB                                    02340000
         L     R1,AJOLGEN                                         75128 02350000
         USING GENDETS,R1                                         75128 02360000
           MVC DDBLKSZE(L'PARMSYSB),PARMSYSB SHIFT IN BLOCK SIZE        02370000
C03LSYSB   IFVALUE DDLRECL,C03LREC                                      02380000
           MVC DDLRECL,=H'80'                                    80290  02390000
C03LREC    IFVALUE DDRECFM,C03FINDO                                     02400000
           MVC DDRECFM(2),=C'FB'                                        02410000
C03FINDO   EQU *                                                        02420000
* NEW FOR 5.2                                                     J52   02421000
         CLC   =C'DBF',ICOMMAND                                   J52   02422000
         BNE   C03FNDO2                                           J52   02423000
         JOLRETN  RC=0                                            J52   02424000
C03FNDO2   DS  0H                                                 J52   02425000
* THE NEXT PIECE OF CODE FROM HERE TO LABEL 'C03STRIT' GOES             02430000
*    SOMETHING LIKE THIS:-                                              02440000
*                                                                       02450000
* C03FINDO:FIND DSID NAME IN TABLE;                                     02460000
*          IF NOT_THERE, GO TO C03STRIT;       /* STORE NEW NAME */     02470000
*     /* NAME IS IN TABLE */                                            02480000
*                                                                       02490000
*          IS THIS CURRENT NAME 'EXTERNAL'                              02500000
*              YES, RETURN (2 EXTERNALS, IGNORE SECOND)                 02510000
*     /* NO */                                                          02520000
*          SAVE R1 IN R7       /* R1 -> NAME IN TABLE */                02530000
*          IS THIS_LEVEL = OLD_LEVEL ?                                  02540000
*              NO-> C03NEWID;                  /* DIFF LEVEL, NEW DSID  02550000
*                                              */                       02560000
*     /* HERE OVER-RIDE */                                              02570000
*          ISSUE MESSAGE;                                               02580000
*          MOVE CURRENT DSID TO WORK;                                   02590000
*          READ OLD ONE INTO TRANS;                                     02600000
*C03TYP9:  DO MERGE OF ATTRIBUTES;                                      02610000
*C03LIKE:  WAS LIKE SPECIFIED ?                                         02620000
*          NO; DO;                                                      02630000
*              IS THIS EXTERNAL? YES, SET LEVEL=0;                      02640000
*              OUTPUT DSID TO WORK FILE;                                02650000
*              MOVE TTR ETC TO IDTABLE(R7);                             02660000
*              RETURN;                                                  02670000
*          END;                                                         02680000
*     /* LIKE WAS SPECIFIED */                                          02690000
*          MOVE DSID TO WORK;                                           02700000
*          GET THE LIKE ONE INTO TRANS;                                 02710000
*          CLEAR LIKE INDICATOR SO NO LOOP;                             02720000
*          GO  TO C03TYP9;     /* NOTE, R7 SET CORRECTLY */             02730000
*                                                                       02740000
*C03NEWID: SET R1 TO R0;       /* R0 = EMPTY SPOT IN TABLE*/            02750000
*C03STRIT: SET R7 TO R1;                                                02760000
*          ADD 1 TO NOIDS;     /* ADD 1 TO NUMBER OF NAMES IN TABLE */  02770000
*          GO  TO C03LIKE;     /* CHECK IF 'LIKE' SPECIFIED, OUTPUT     02780000
*                              AND STORE NAME IN TABLE */               02790000
*                                                                       02800000
***** AND THATS IT ****                                                 02810000
*                                                                       02820000
* NOW WE HAD BETTER STORE THIS DD'CARD' AND ENTER ITS NAME              02830000
*     INTO THE IDENTIFIER TABLE                                         02840000
          $CALL UJS17FID,DDDSID                                 74256   02850000
           LTR R15,R15    WAS IT ALREADY THERE ?                        02860000
           BNZ  C03STRIT NO,SO MERELY STORE IT                          02870000
* HERE THE DATA SET IDENTIFIER HAS BEEN DOUBLY DECLARED.                02880000
         SPACE 2                                                  75128 02890000
         CLI   C03DEXT,C' '   WAS EXTERNAL CODED ?                75128 02900000
         BE    C03DOVRD       NO, DO OVERIDE                      75128 02910000
         JOLRETN RC=0                                             75128 02920000
C03DOVRD EQU   *                                                  75128 02930000
         SPACE 2                                                  75128 02940000
* THE THING TO NOW IS TO READ THE OLD ONE IN (THE FIRST DECLARE)        02950000
* AND OVERWRITE THIS (THE 2ND) DECLARE WITH ANY NON-BLANK INFO          02960000
* FROM THE FIRST.                                                       02970000
           LR R7,R1            SAVE THE ID ADDRESS FROM THE TABLE       02980000
*                              COS WEHN WE RE-WRITE IT,WE WILL          02990000
*                              HAVE TO UPDATE THE ADDRESS ON DISC       03000000
*                              (OR CORE)                                03010000
********* HOWEVER, THE LEVEL WE ARE CURRENTLY AT COULD BE A LITTLE      03020000
*     HIGHER THAN THE ONE IN THE TABLE,AND THIS (BEING A DECLARE)       03030000
*     MUST GO INTO THE TABLE AS A NEW ITEM (AT A HIGHER LEVEL)          03040000
           USING IDTABLE,R7                                             03050000
           CLC IDLEVEL,LEVEL+1                                          03060000
           BNE C03NEWID                                                 03070000
         TM    IDTYPE,X'03'   IS THIS A DSID ?                    75128 03080000
           BO C03OVRD                                                   03090000
C03ERR15 EQU   *                                                  75128 03100000
         JOLERR 308,'DSID NAME ''',DDDSID,''' WAS PREVIOUSLY DECLARED A*03110000
               T ',IDSTMT,' AND WAS NOT A DSID:- NO MERGE CAN OCCUR'    03120000
           JOLRETN RC=16                                                03130000
C03OVRD   EQU  *                                                        03140000
           SPACE 2                                                      03150000
           MVC WORK(255),DDDSNDET SHIFT TO WORK TO SAVE                 03160000
          $CALL UJS16GID,WORK+5 ********** UJS16GID CLEARS TRANS  75128 03170000
           JOLERR 007,'OVERRIDING/MERGING STATEMENT ',IDSTMT      75311 03180000
* AND SO WE HAVE THE FOLLOWING SITUATION:-                              03190000
*     1.  THE OLD DSID IS IN TRANS                                      03200000
*     2.  THE NEW DSID IS IN WORK                                       03210000
* NOW ANY INFORMATION THAT IS IN THE NEW ONE THAT ISN'T IN THE OLD75128 03220000
*  ONE MUST BE SHIFTED TO THE NEWONE                              75128 03230000
           LA  R4,TRANS        STILL A USING FOR DDDSNDET               03240000
           LA R6,WORK                                                   03250000
C03DOLIK EQU   *                                                  75128 03260000
           IFVALUE DDDSNAME,C03LDSN            ALREADY HAS VALUE,LEAVE  03270000
           MVC DDDSNAME,DDDSNAME-DDDSNDET(R6)                           03280000
           MVC DDMBR,DDMBR-DDDSNDET(R6)                                 03290000
            MVC  DDTYPE,DDTYPE-DDDSNDET(R6)                             03300000
C03LDSN    EQU *                                                        03310000
C03LMBR    IFVALUE DDVOLUME,C03LVOL            ALREADY HAS VALUE,LEAVE  03320000
           MVC DDVOLUME,DDVOLUME-DDDSNDET(R6)                           03330000
C03LVOL    IFVALUE DDUNIT,C03LUNIT             ALREADY HAS VALUE,LEAVE  03340000
           MVC DDUNIT(L'DDUNIT+L'DDUNITNO+L'DDUNITYP),DDUNIT-DDDSNDET(R*03350000
               6)                                                       03360000
C03LUNIT   IFVALUE DDPRIM,DDSEC,DDDIRECT,C03LSPC LEAVE AS IS            03370000
           MVC DDPRIM(L'DDPRIM+L'DDSEC+L'DDDIRECT+L'DDCYLTRK),DDPRIM-DD*03380000
               DSNDET(R6)                                               03390000
C03LSPC    IFVALUE DDRECFM,C03LRECF           ALREADY HAS VALUE,LEAVE   03400000
         MVC   DDRECFM,DDRECFM-DDDSNDET(R6)              JOL30053 76200 03410000
C03LRECF IFVALUE DDBLKSZE,C03LBLKS                       JOL30053 76200 03420000
         MVC   DDBLKSZE,DDBLKSZE-DDDSNDET(R6)            JOL30053 76200 03430000
C03LBLKS IFVALUE DDLRECL,C03LRECL                        JOL30053 76200 03440000
         MVC   DDLRECL,DDLRECL-DDDSNDET(R6)              JOL30053 76200 03450000
C03LRECL IFVALUE DDCATLGS,C03LCATS                       JOL30053 76200 03460000
         MVC   DDCATLGS,DDCATLGS-DDDSNDET(R6)            JOL30053 76200 03470000
C03LCATS IFVALUE DDBUFL,C03LBUFL                         JOL30053 76200 03480000
         MVC   DDBUFL,DDBUFL-DDDSNDET(R6)                JOL30053 76200 03490000
C03LBUFL IFVALUE DDBUFNI,C03LBFNI                                 82300 03500000
         MVC   DDBUFNI,DDBUFNI-DDDSNDET(R6)                       82300 03510000
C03LBFNI IFVALUE DDBUFND,C03LBFND                                 82300 03520000
         MVC   DDBUFND,DDBUFND-DDDSNDET(R6)                       82300 03530000
C03LBFND IFVALUE DDVOLSEQ,C03LVSEQ                       JOL30053 76200 03540000
         MVC   DDVOLSEQ,DDVOLSEQ-DDDSNDET(R6)            JOL30053 76200 03550000
C03LVSEQ IFVALUE DDMAXVOL,C03LMXV                        JOL30053 76200 03560000
         MVC   DDMAXVOL,DDMAXVOL-DDDSNDET(R6)            JOL30053 76200 03570000
C03LMXV  IFVALUE DDCODE,C03LCODE                         JOL30053 76200 03580000
         MVC   DDCODE,DDCODE-DDDSNDET(R6)                JOL30053 76200 03590000
C03LCODE IFVALUE DDFUNC,C03LFUNC                         JOL30053 76200 03600000
         MVC   DDFUNC,DDFUNC-DDDSNDET(R6)                JOL30053 76200 03610000
C03LFUNC IFVALUE DDSIZE(DDSIZEQ-DDSIZE),C03LSIZE         JOL30053 76200 03620000
         MVC   DDSIZE(DDSIZEQ-DDSIZE+L'DDSIZEQ),DDSIZE-DDDSNDET(R6) 200 03630000
C03LSIZE IFVALUE DDBUFNO,C03LBUF            ALREADY HAS VALUE,LEAVE     03640000
         MVC DDBUFNO,DDBUFNO-DDDSNDET(R6)                               03650000
C03LBUF  IFVALUE DDOPTCD,C03LOPTC           ALREADY HAS VALUE,LEAVE     03660000
         MVC DDOPTCD,DDOPTCD-DDDSNDET(R6)                               03670000
C03LOPTC IFVALUE DDDENS,C03LDENS            ALREADY HAS VALUE,LEAVE     03680000
         MVC DDDENS,DDDENS-DDDSNDET(R6)                                 03690000
C03LDENS IFVALUE DDRKP,C03LRKP              ALREADY HAS VALUE,LEAVE     03700000
         MVC DDRKP,DDRKP-DDDSNDET(R6)                                   03710000
C03LRKP  IFVALUE DDKEYLEN,C03LKEYL          ALREADY HAS VALUE,LEAVE     03720000
         MVC DDKEYLEN,DDKEYLEN-DDDSNDET(R6)                             03730000
C03LKEYL IFVALUE DDOVERFL,C03LOVRF          ALREADY HAS VALUE,LEAVE     03740000
         MVC DDOVERFL,DDOVERFL-DDDSNDET(R6)                             03750000
C03LOVRF IFVALUE DDDSORG,C03LDSRG           ALREADY HAS VALUE,LEAVE     03760000
         MVC DDDSORG,DDDSORG-DDDSNDET(R6)                               03770000
C03LDSRG IFVALUE DDLABEL,C03LLAB            ALREADY HAS VALUE,LEAVE     03780000
         MVC DDLABEL,DDLABEL-DDDSNDET(R6)                               03790000
C03LLAB  IFVALUE DDAEXTRA,C03LPREF          ALREADY HAS VALUE,LEAVE     03791000
         MVC DDAEXTRA,DDAEXTRA-DDDSNDET(R6)                             03792000
C03LPREF EQU    *           IFVALUE DDRETPD,C03LRTP                DASD 03800000
*        MVC   DDRETPD,DDRETPD-DDDSNDET(R6)                        DASD 03810000
C03LRTP  IFVALUE DDEXPDT,C03LEXP                                  75128 03820000
*DDRETPD AND DDEXPDT ARE SAME REALLY--MUST MOVE RETPD IF EXPDT     DASD 03830000
         MVC   DDRETPD,DDRETPD-DDDSNDET(R6)                        DASD 03840000
         MVC   DDEXPDT,DDEXPDT-DDDSNDET(R6)                       75128 03850000
C03LEXP  EQU   *                                                  75128 03860000
* THERE ARE A FEW THINGS THAT NEED COPYING BUT IN A 'BIT' FASHION 75128 03870000
         OC    DDSPECT2,DDSPECT2-DDDSNDET(R6)                     75128 03880000
         OC    DDSPECTP,DDSPECTP-DDDSNDET(R6)                     75128 03890000
         OC    DDUNITQU,DDUNITQU-DDDSNDET(R6)                     82200 03900000
         IFVALUE DDLABTYP,C03LTYP                                 75128 03910000
         MVC   DDLABTYP,DDLABTYP-DDDSNDET(R6)                           03920000
C03LTYP  EQU   *                                                        03930000
*                                                                       03940000
* NOW CHECK IF 'DCB-EXTRA' WAS CODED ON OLD, BUT NOT ON NEW,AND   75128 03950000
*        COPY IF SO                                               75128 03960000
         CLC   DDOSVB,=AL2(DDLEN)  LONGER THAN USUAL ?            75128 03970000
         BH    C03LEXTR            YES,LEAVE EXTRA                75128 03980000
         CLC   DDOSVB-DDDSNDET(R6),=AL2(DDLEN) IS OLD RECORD LONG?75128 03990000
         BNH   C03LEXTR            NO, BOTH RECORDS ARE SHORT     75128 04000000
         MVC   DDOSVB,DDOSVB-DDDSNDET(R6) SWAP LENGHTS            75128 04010000
         MVC   DDEXTRA,DDEXTRA-DDDSNDET(R6) SHIFT 'EXTRA' INFO    75128 04020000
C03LEXTR EQU   *                                                  75128 04030000
C03WRITE   EQU *                                                        04040000
C03WRIT2 EQU   *                                                  75128 04050000
         CLI   C03DLIKE,C' '  WAS LIKE CODED ?                    75128 04060000
         BE    C03TEXTA       NOPE,-> TEST EXTERNAL NOW           75128 04070000
         MVC   WORK(250),DDDSNDET SAVE OLD ONE                    75128 04080000
        $CALL  UJS16GID,C03DLIKE GET THE 'LIKE' ONE               75128 04090000
         LTR   R15,R15        WAS IT THERE ?                      75128 04100000
         BZ    C03TTYP9       YES, CHECK THAT IT IS A DS DCL NOW  75128 04110000
         MVC   ERRNUM1,C03DLIKE   JOLERR CAN'T USE BASE 13,MOVE IT80290 04120000
         CLEAR ERRNUM2                                            80290 04130000
         MVC   ERRNUM2(3),C03DLIKE+L'ERRNUM1                      80290 04140000
         JOLERR 304,'CANNOT FIND LIKE DSID ''',ERRNUM1,ERRNUM2,''''     04150000
         CLEAR  C03DLIKE    SO WE WON'T LOOP                      75128 04160000
         LA  R4,WORK    SWITCH TO WORK FOR OUTPUT                 75128 04170000
         B     C03TEXTA       STILL STORE IT THOUGH               75128 04180000
         SPACE 2                                                  75128 04190000
C03TTYP9   EQU *                                                  75311 04200000
        CLEAR  C03DLIKE    SO WE WON'T LOOP                       75311 04210000
        LA   R4,WORK                                              75311 04220000
        LA   R6,TRANS                                             75311 04230000
         TM    IDTYPE-IDTABLE(R1),X'03'   IS THIS A DSID ?        75311 04240000
         BO    C03DOLIK       NOW GO DO THE 'LIKE' THING          75128 04250000
         B     C03ERR15       NOPE, ERROR, RETURN                 75128 04260000
         SPACE 2                                                  75128 04270000
C03TEXTA CLI   C03DEXT,C' '   EXTERNAL CODED ?                    75128 04280000
         BE    C03NOTEX       NOPE                                75128 04290000
         MVI   DDLEVEL,0      SET LEVEL TO 0                      75128 04300000
C03NOTEX EQU   *                                                  75128 04310000
* NOW JUST BEFORE THE DSID, SEE IF SUBSYS WAS CODED, AND WRITE    87150 04320000
* IT OUT IF NECESSARY. LONG VOLUMES WILL BE DONE LATER.           87150 04330000
         IFNULL #DDSUBS,C03NOMOR  NO EXTRA SEGMENTS TO GO OUT     87150 04340000
         LH    R15,#DDSUBS     GET LENGTH OF ITEM                 87150 04350000
         LA    R15,#DDSUBS-DDLENXTR+2(,R15) + LENGTH OF PREFIX    87150 04360000
         STH   R15,DDLENXTR    SET LENGTH FOR WRITE ROUTINE       87150 04370000
         $CALL UJS15OP,DDLENXTR                                   87150 04390000
          LTR R15,R15                                                   04400000
          BNZ C03RETN0    COULDN'T STORE IT,ERROR MESSAGE WILL          04410000
*                         HAVE BEEN GIVEN                               04420000
          ST  R1,DDAEXTRA      SAVE ADDRESS IN DDDSNDETS          87150 04430000
          SPACE 3                                                       04430100
C03NOMOR DS    0H                                                 87150 04430200
* NOW JUST BEFORE OUTPUTTING THE DSID, CHECK IF 'DUMMY' WAS             04431000
* CODED BEFORE A DSNAME (DDTYPE COULD BE SET INCORRECTLY)               04432000
           CLC  =C'*DUMMY',DDDSNAME                                     04433000
           BNE  *+8                                                     04434000
           MVI  DDTYPE,DDWORKDS    SET NON REL GEN(DONT CARE WHAT       04435000
*                                  IT IS AS LONG AS ITS NOT REL         04436000
*                                  GENERATION)                          04437000
          $CALL UJS15OP,DDDSNDET                                74256   04438000
          LTR R15,R15                                                   04439000
          BNZ C03RETN0    COULDN'T STORE IT,ERROR MESSAGE WILL          04439100
*                         HAVE BEEN GIVEN                               04439200
           ST R1,IDADDR                                                 04439300
           MVC IDSTMT,STMT                                              04440000
           MVC IDNAME,DDDSID                                            04450000
         MVI   IDTYPE,X'03'   TURN ON DSID INDICATOR              75128 04460000
         CLI   DDVOLUME,C'-'  VOLREF ? IF SO WE'D BETTER ADVISE   75128 04470000
         BNE   *+8            - SOMEONE LATER ON.                 75128 04480000
         OI    IDTYPE,X'04'   TURN ON VREF INDICATOR              75128 04490000
         MVC   IDLEVEL,DDLEVEL                                    75128 04500000
           MVC IDNEST,NEST+1                                            04510000
           MVI IDUSED,0                                                 04520000
C03RETN0   JOLRETN                                                      04530000
           SPACE 2                                                      04540000
C03NEWID   LR    R1,R0            NEXT SPOT IN TABLE ENTRY              04550000
          SPACE 3                                                       04560000
C03STRIT   LA    R4,DDDSNDET                                            04570000
           LR    R7,R1           SAVE ID TABLE ADDRESS                  04580000
           LH    R1,NOIDS                                               04590000
           LA    R1,1(R1)                                               04600000
           STH   R1,NOIDS                                               04610000
           B     C03WRITE         STORE THE DSID AWAY FOR LATER USE     04620000
           TITLE 'SCAN FOR KEYWORDS AND DECODE'                         04630000
FINDKEY    EQU *                                                        04640000
           GETTKN LOCN=TKNCURR                 GET THE NEXT TOKEN       04650000
           CLC   TKNCURR,TKNNO                                          04660000
           BH    C                                                      04670000
           STH   R1,TKNCURR                                             04680000
           CLI   TKN,C','                        IS IT A COMMA?         04690000
           BE    FINDKEY                                                04700000
         CLI   TKN,C')'       LEFT OVER ?                         75128 04710000
         BE    FINDKEY        YES,SKIP IT                         75128 04720000
         CLI   TKN,C'='       EQUAL LEFT OVER            JOL30079 76200 04730000
         BE    FINDKEY                                   JOL30079 76200 04740000
           TITLE 'TEST FOR A KEY-WORD'                                  04750000
           LR  R5,R1           SET R5=TKNNO OF NEXT TOKEN               04760000
           BCTR R5,0           NOW R5=TKNNO OF THIS TOKEN               04770000
           CLI TKNTYPE,0       IS THIS TOKEN NUMERIC ?            74256 04780000
           BE  C03NUM01        YES,SO IT CANT BE A DSN WITH NO KEY74256 04790000
         CLI   TKN,C''''      DSN CODED AS 'DSNAME'?              75311 04800000
         BE    C03QDSN        YES, GO STORE R1, THEN START DSN    75311 04810000
           CLI TKNTYPE,2       IS THIS TOKEN A CHARACTER ?        74256 04820000
           BNE C03NOTSP        NO,MUST BE A LITERAL OR SPECIAL    74256 04830000
*                              SO KICK IT OUT                     74256 04840000
          GETTKN REG=R1                                                 04850000
         CLC   =C'||',TKN     DSN TYPE A||B.C ?                   75311 04860000
         BE    C03DSNNK       YES                                 75311 04870000
          CLI TKN,C'.'                                                  04880000
           BNE C03NOTSP        NO,TEST IF A KEYWORD               74256 04890000
* HERE IT IS A DSN WITH NO KEYWORD                                      04900000
C03DSNNK EQU   *                                                  75311 04910000
           GETTKN (R5)                                                  04920000
C03QDSN  EQU   *                                                  75311 04930000
          STH R1,TKNCURR                                                04940000
          B STARTDSN                                                    04950000
C03NUM01   LR  R8,R5           R8=TKNNO OF *THIS* NUMERIC TOKEN   74256 04960000
         MVC   #WORK(20),#TKN SAVE THIS NUMERIC TOKEN             75128 04970000
           GETTKN (R1)         GET TOKEN AFTER NUMBER             74256 04980000
           CLC =C'PART ',TKN   <NUMBER> PART ?                    74256 04990000
           BNE C03TCOPY        NO,TEST IF 'COPIES' FOR PRINTER    74256 05000000
* PART NUMBER HERE                                                74256 05010000
           STH R1,TKNCURR      STORE NUMBER TO SKIP 'PART' LATER  74256 05020000
         CLI   DDTYPE,DDSYSOUT SYSOUT ?                           75128 05030000
           BNE C03SYS1E        ERROR                              74256 05040000
         JOLSTOR 'PART NUMBER',DDSYSFRM,#WORK                     75128 05050000
         GETTKN TKNCURR        GET NEXT TOKEN                           05060000
         CLC =C'STATIONERY ',TKN                                        05070000
         BE   SKIP1                                                     05080000
         CLC  =C'PAPER ',TKN                                            05090000
         BE   SKIP1                                                     05100000
           B   C               BACK TO MAIN PROCESSING            74256 05110000
C03TCOPY   CLC =C'COPIES ',TKN <NUMBER> COPIES ?                  74256 05120000
         BNE   C03TREC        NO, TEST RECORDS THEN               75128 05130000
           STH R1,TKNCURR      STORE SO WE SKIP 'COPIES' LATER    74256 05140000
         CLI   DDTYPE,DDSYSOUT SYSOUT ?                           75128 05150000
           BNE C03SYS1E        NO,CAN'T HAVE 'COPIES' THEN        74256 05160000
DSCOPIES JOLSTOR 'COPIES',DDCOPIES,#WORK,NUM                      75128 05170000
           B   C               AND ON TO MAIN LINE                74256 05180000
C03SYS1E   GETTKN (R1)                                            74256 05190000
           B   C03PRONL                                           75311 05200000
           SPACE                                                        05210000
* NOW TEST IF  NK | N-NZ RECORDS | 2400-3 TYPE UNIT               75128 05220000
C03TREC  EQU   *                                                  75128 05230000
* IN FACT BEFORE TESTING RECORD NUMBERS, WE WILL TEST                   05240000
* THAT HE DIDN'T CODE 3 UNITS                                           05250000
         B     C03TREC2       ********                            75128 05260000
         CLC =C'UNITS ',TKN                                             05270000
         BNE  C03TREC2                                                  05280000
         MVC #TKN(30),#WORK                                             05290000
         B   DSUNITNO        GO STORE UNIT NUMBERS                      05300000
C03TREC2 EQU *                                                          05310000
         CLC   =C'K ',TKN     20K (RECORDS?)                      75128 05320000
         BE    C03RECS                                            75128 05330000
         CLC   =C'BYTES ',TKN 2000 BYTES (RECORDS | SIZE)         75128 05340000
         BE    C03RECS                                            75128 05350000
         CLC   =C'RECS ',TKN                                      75128 05360000
         BE    C03RECS                                            75128 05370000
         CLC   =C'RECORDS ',TKN                                   75128 05380000
         BE    C03RECS                                            75128 05390000
         CLI   TKN,C'-'       1000-3000 RECS  | 2400-3 ?          75128 05400000
         BNE   C03TBPI        NO, TEST BPI THEN....               75128 05410000
         LA    R1,1(R1)       SKIP NEXT ITEM                      75128 05420000
         GETTKN (R1)          NOW, IF ITS NOT 'RECORDS' | 'RECS'        05430000
*                             WE WILL ASSUME THAT IT IS A UNIT          05440000
*                             FOR NOW, BUT IT WILL BE PROPERLY          05450000
*                             VALIDATED LATER, ANYWAY                   05460000
         CLC   =C'K ',TKN     20K (RECORDS?)                      75128 05470000
         BE    C03RECS                                            75128 05480000
         CLC   =C'BYTES ',TKN 2000 BYTES (RECORDS | SIZE)         75128 05490000
         BE    C03RECS                                            75128 05500000
         CLC   =C'RECS ',TKN                                      75128 05510000
         BE    C03RECS                                            75128 05520000
         CLC   =C'RECORDS ',TKN                                   75128 05530000
         BE    C03RECS                                            75128 05540000
* HERE WE MUST TEMPORARILY ASSUME A UNIT OF THE TYPE '2400'       75128 05550000
         LA    R1,1(R8)       GET THE '-'                         75128 05560000
         GETTKN (R1)                                              75128 05570000
         BAL   R14,CONCAT     CONCAT TO #WORK                           05580000
         GETTKN (R1)          GET THE THING AFTER '-'             75128 05590000
         BAL   R14,CONCAT     CONCATENATE IT AS WELL              75128 05600000
         SPACE 1                                                        05610000
         MVC   #TKN(30),#WORK                                           05620000
         STH   R1,TKNCURR     RESET R1 INTO TKNCURR               75128 05630000
         B     C03TKEYW                                           75128 05640000
         SPACE 2                                                        05650000
C03TBPI    CLC =C'BPI ',TKN    BPI ?                              74256 05660000
         BNE   C03TDAYS                                           75128 05670000
           STH R1,TKNCURR      STORE R1 TO IGNORE 'BPI' NEXT TIME 74256 05680000
           LA  R1,C03BPITB     LA IN R1 OF START OF TABLE         74256 05690000
           LA  R14,6           AND 14=INCREMENT                   74256 05700000
           LA  R15,C03BPITE-6  AND END OF TABLE-6                 74256 05710000
           SPACE 1                                                74256 05720000
           CLC WORK(5),0(R1)   CHECK BPI NUMBER                   75311 05730000
           BE  C03BPIOK        GOT IT ->                          74256 05740000
           BXLE R1,R14,*-10    LOOP                               74256 05750000
         JOLERR 310,'BPI ',#WORK,' IS INCORRECT:S/B 800,1600 OR 6250'   05760000
           B   C               BACK TO PROCESSING LOOP            74256 05770000
C03BPITB DC    CL5'800  ',C'2',C'1600 ',C'3',C'6250 ',C'4'        75128 05780000
C03BPITE   EQU *                                                  74256 05790000
C03BPIOK   EQU *                                                  74256 05800000
           MVC TKN(1),5(R1)    SHIFT IN CODE                      74256 05810000
           MVI #TKN+1,1        SET LENGTH TO '1'                  74256 05820000
           JOLSTOR 'BPI',DDDENS,#TKN  STORE BPI CODE              75311 05830000
           B   C                                                        05840000
         SPACE 3                                                        05850000
C03TDAYS CLC   =C'DAYS ',TKN  DAYS?                               75128 05860000
         BE    C03DAYS             -> YES                         75128 05870000
         CLC   =C'DAY ',TKN   1 DAY ?                             75128 05880000
         BNE   C03TSIZE            -> NO                          75128 05890000
C03DAYS  STH   R1,TKNCURR     HERE IT IS RETPD                    75128 05900000
         GETTKN (R8)          GET THE NUMBER AGAIN                75128 05910000
C03STRTP JOLSTOR 'RETENTION PERIOD',DDEXPDT,#WORK,NUM             76200 05920000
         LTR   R15,R15                                   JOL30055 76200 05930000
         BNZ   C                                         JOL30055 76200 05940000
         MVI   DDRETPD,C'R'                              JOL30055 76200 05950000
         B     C              BACK TO MAIN LINE                   75128 05960000
         SPACE 3                                                  75128 05970000
C03TSIZE CLC   =C'K ',TKN     DID USER SAY LOOK (STORAGE REQ)     75128 05980000
         BNE   C03TSPC2       NOPE                                75128 05990000
         STH   R1,TKNCURR     YES,RESET TKN CURR                  75128 06000000
         GETTKN (R8)          GET THE NUMBER AGAIN                75128 06010000
         B     DSSIZE         GO STORE IT                         75128 06020000
C03TSPC2   EQU  *                                                       06030000
           LA  R15,C03SPTBL    SPACE TABLE CONSTANTS              74256 06040000
C03TSPC4   CLC TKN(L'C03SPTBL),0(R15) IS IT A SPACE KEYWORD ?     74256 06050000
           BE  C03ISPC                YES ->                      74256 06060000
           LA  R15,L'C03SPTBL(R15) ADD TO LOOP                    74256 06070000
           C   R15,=A(C03SPTBE)    REACHED END OF TABLE ?         74256 06080000
           BL  C03TSPC4            NO,CHECK NEXT ENTRY            74256 06090000
* SORRY,BXLE NOT POSSIBLE,NO REGISTERS                            74256 06100000
* NOW CHECK IF NEXT TOKEN IS A COMMA FOLLOWED BY A <NUMBER>,            06110000
*     FOLLOWED BY 'TRKS' ETC AGAIN                                      06120000
           CLI TKN,C','                                                 06130000
           BNE C03NOTSP        NO,SO PREVIOUS NUMBER NOT SPACE          06140000
C03N2NDS   GETTKN (R1)                                            75311 06150000
           CLI  TKN,C','                                          75311 06160000
           BE   C03N2NDS                                          75311 06170000
           CLI TKNTYPE,0       <NUMBER>                                 06180000
           BNE C03NOTSP        NOT A SPACE LIKE 1,2TRKS WITHOUT KEYWORD 06190000
           GETTKN (R1)         IT IS MAYBE HERE COS WE HAVE <NO>,<NO>   06200000
*                              SO GET THE 'TRKS' HOPEFULLY              06210000
           B   C03TSPC2        -> GO TEST NOW FOR 'TRKS' ETC            06220000
           SPACE 3                                                      06230000
C03KEYWD EQU   *                                                  75128 06240000
C03NOTSP   EQU  *                                                       06250000
* NOT SPACE WITHOUT A KEYWORD                                           06260000
           GETTKN REG=R5       GET ORIGINAL NUMBER AGAIN                06270000
C03TKEYW   EQU *                                                        06280000
         MVC   DBL(8),TKN      COPY SO BIN SEARCH CAN GET IT      86210 06280100
         $CALL C03FKEY         FIND THE KEYWORD IN THE TABLE      86210 06280200
         LTR   R15,R15         GOT IT?                            86210 06280300
         BNZ   GOTKEYWD        YES                                86210 06280400
           SPACE 3                                                      06350000
         L     R1,AJOLGEN                                         75128 06360000
         L     R1,AGENUNIT-UJGENDET(R1)                           75128 06370000
           LM R14,R15,4(R1)                                             06380000
           L  R1,0(R1)                                                  06390000
TGENU      CLC TKN(8),0(R1)                                             06400000
           BE  GOTGENU                                                  06410000
           BXLE R1,R14,TGENU                                            06420000
* NOW CHECK FOR A PREFERRED VOLUME                                75128 06430000
**** THIS WAS BEFORE THE GENERIC UNIT CHECK, BUT AS THE UNIT      75128 06440000
*  WILL  BE CODED MORE OFTEN THAN THE VOLUMES, WE HAVE MOVED      75128 06450000
*  IT TO SAVE  CPU TIME                                           75128 06460000
         SPACE 1                                                  75128 06470000
        L   R1,AJOLGEN                                            75128 06480000
         L     R1,APREFVOL-GENDETS(R1)                            75128 06490000
         LM    R14,R15,4(R1)                                      75128 06500000
         L     R1,0(R1)                                           75128 06510000
C03TPREF CLC   TKN(6),0(R1)                                       75128 06520000
         BE    GOTPREFV                                           75128 06530000
         BXLE  R1,R14,C03TPREF                                    75128 06540000
         SPACE 2                                                        06550000
*************** NOW CHECK THE DEVICE NAME TABLE **************          06560000
*                                                                       06570000
* CHANGED TO A CALL OF UJC03DEV IN DECEMBER, 1983 FOR XA SUPPORT        06580000
*                                                                       06590000
         $CALL UJC03DEV,(TKN,DDDSNDET) EITHER SEARCH DEVNAMET        XA 06600000
*                                      OR CALL XA LOOK UP            XA 06610000
         LTR   R15,R15        WAS IT A DEVICE OR UNIT NAME?          XA 06620000
         BZ    C03DEVUN       YEP                                    XA 06630000
*                                                                       06640000
* OK,GIVE CONTROL TO A USER EXIT                                        06650000
         SPACE 2                                                  75128 06660000
* OK NOW WE REALLY HAVE A PROBLEM COS WE HAVEN'T A CLUE WHAT            06670000
*    IT IS BUT WE SHALL PRESS ON REGARDLESS.                            06680000
WHATISIT   EQU *                                                        06690000
* NOW WE HAVE A WORD THAT WE DON'T UNDERSTAND SO CALL THE USER          06700000
* TO DO AS HE WISHES                                                    06710000
           SPACE                                                        06720000
C03USER    EQU *                                                        06730000
         L     R15,ACOMPEXI   GET COMPILER EXIT ROUTINE ADDRESS   75128 06740000
         L     R15,8(R15)                                         75128 06750000
           LTR R15,R15                                                  06760000
           BZ C03ERR                                                    06770000
         $CALL (15),(CALLAREA,TKNX,DDDSNDET)                      75128 06780000
           LTR R15,R15                                                  06790000
         BNZ   C03ERR         EXIT DIDN'T FIX IT                  75128 06800000
* NOW WE MUST SEARCH THE TABLE (KEYWORD) AND TRY AND FIND         75128 06810000
*  THE KEYWORD THE USER GAVE BACK TO US                           75128 06820000
         $CALL C03FKEY         FIND THE KEYWORD IN THE TABLE      86210 06821000
         LTR   R15,R15         GOT IT?                            86210 06822000
         BNZ   GOTKEYUS        YES                                86210 06823000
* WELL, ERROR HERE I'M AFRAID                                     75128 06890000
         B     C03INV                                                   06900000
         B     C                                                  75128 06910000
GOTKEYUS EQU *                                                          06920000
       LH  R15,TKNCURR                                                  06930000
       BCTR R15,0                                                       06940000
       STH  R15,TKNCURR                                                 06950000
       B    GOTKEYWD                                                    06960000
C03ERR     EQU *                                                        06970000
         MVC   #WORK(L'TKN),#TKN                                  75128 06980000
C03NERR2 GETTKN TKNCURR                                           75128 06990000
         CLI   TKN,C'='                                           75128 07000000
         BE    C03CONEQ                                           75128 07010000
         CLI   TKN,C'('                                           75128 07020000
         BE    C03CONEQ                                           75128 07030000
C03INV   CLI   WORK,C'*'                                                07040000
         BE    C                                                        07050000
         JOLERR 301,'''',#WORK,''' IS NOT A VALID KEYWORD:-IGNORED'     07060000
         B     C              BACK TO MAINLINE                    75128 07070000
         SPACE 1                                                  75128 07080000
C03CONEQ BAL   R14,CONCAT                                         75128 07090000
C03CONE2 GETTKN (R1)                                              75128 07100000
         BAL   R14,CONCAT                                         75128 07110000
         CLI   TKN,C'('                                           75128 07120000
         BE    C03CONE2                                           75128 07130000
         STH   R1,TKNCURR                                         75128 07140000
         B     C03NERR2                                           75128 07150000
         SPACE 2                                                  75128 07160000
GOTKEYWD   EQU *                                                        07170000
* PREVIOUSLY, THERE USED TO BE TWO TABLES, ONE CONTAINING         75128 07180000
*  KEYWORDS SUCH AS VB (IE NO KEYWORD EXPECTED AFTER) AND         75128 07190000
*  KEYWORDS SUCH AS DSN.                                          75128 07200000
* THE NEW TABLE CONTAINS AND INDICATOR TO SAY WHETHER WE HAVE     75128 07210000
*  TO FIND THE VALUE AFTER THE KEYWORD, OR NOT                    75128 07220000
         LR    R1,R15         COPY TABLE POSITION TO R1           86210 07221000
         MVC   #WORK(L'TKN+2),#TKN SAVE KEYWORD FOR ERR-MSSGE     75128 07230000
         MVC   DBL(2),C03LA10 MOVE LA R10 INSTRUCTION TO DBL      75128 07240000
         MVC   DBL+2(2),10(R1) SHIFT IN S(RTN)                    75128 07250000
         EX    R0,DBL         LOAD R10 WITH RTN                   75128 07260000
         SPACE 1                                                        07270000
* NOW WE HAD BETTER CHECK OUR INDICATORS TO SAY WHETHER THIS      75128 07280000
*  KEYWORD WE HAVE GOT IS EXPECTING A VALUE AFTER IT OR NOT       75128 07290000
         SPACE 1                                                  75128 07300000
         ST    R1,DBL         SAVE POINTER TO TABLE FOR NOW       75128 07310000
         TM    8(R1),X'01'    IF 0 MEANS NO VALUE AFTER KEYWORD   75128 07320000
         BZ    C03BALR        NO VALUE, JUST BRANCH TO ROUTINE    75128 07330000
           GETTKN LOCN=TKNCURR                                          07340000
           CLI TKN,C'='                                                 07350000
           BNE GOTTOKEY                                                 07360000
           GETTKN REG=R1                                                07370000
GOTTOKEY    EQU *                                                       07380000
         CLI   TKN,C'('       '(' FOLLOWING KEYWORD ?             75128 07390000
         BNE   C03GOTRK       NO,USE WHATS HERE                   75128 07400000
         GETTKN (R1)          YES, SKIP IT                        75128 07410000
C03GOTRK EQU   *                                                  75128 07420000
           STH R1,TKNCURR                                               07430000
C03BALR  EQU   *                                                  75128 07440000
         L     R1,DBL         RELOAD POINTER TO TABLE ENTRY       75128 07450000
         TM    8(R1),X'04'    SYSOUT ONLY KEYWORD ?               75128 07460000
         BZ    C03NSYS9       NOPE                                75128 07470000
         CLI   DDTYPE,DDSYSOUT IS THIS A SYSOUT DECLARE ?          SOCO 07480000
         BL    C03PRONL       NOPE,BALR                            SOCO 07490000
         CLI   DDTYPE,DDSPECOU IS THIS A SPECIAL SYSOUT ?          SOCO 07500000
         BNH   C03BALR2        YES, I AM ONE OF THEM, SO BRANCH    SOCO 07510000
C03PRONL JOLERR 311,'''',#WORK,'=',#TKN,''' IGNORED:- FOR SYSOUT ONLY'  07520000
         B     C              BACK TO MAIN-LINE                  75128  07530000
         SPACE 1                                                  75128 07540000
C03NSYS9 TM    8(R1),X'08'    KEY ONLY FOR NON-SYSOUT DATA SET ?  75128 07550000
         BZ    C03BALR2                                           75128 07560000
         CLI   DDTYPE,DDSYSOUT  WELL, IS THIS A SYSOUT DATA SET?  75128 07570000
         BH    C03BALR2         NOPE, GO TO ROUTINE               75128 07580000
         JOLERR 312,'''',#WORK,'=',#TKN,''' IGNORED:- FOR',       75128*07590000
               ' NON-SYSOUT FILES ONLY'                           75128 07600000
         B     C                                                        07610000
C03BALR2 EQU   *                                                        07620000
         LTR   R15,R10                                            75128 07630000
           BZ  C03NOTIM        NOT YET IMPLEMENTED MESSAGE,MATE         07640000
         MVC   #WORK(L'TKN+2),#TKN                                75128 07650000
            BALR R14,R15                                                07660000
           B C                                                          07670000
         SPACE 3                                                        07680000
GOTGENU    MVC TKN(8),8(R1) SWAP UNIT NAMES                             07690000
           MVC DDUNITYP,16(R1) MOVE IN UNIT TYPE                        07700000
C03DEVUN EQU   *              UNIT FOUND IN DEVNAMET                 XA 07710000
C03SET8    MVI #TKN+1,8        SET LENGTH TO 8                    74256 07720000
           B   DSUNIT                                                   07730000
C03ISPC    GETTKN REG=R8                                                07740000
           B  DSSPACE                                                   07750000
           SPACE                                                        07760000
GOTPREFV   EQU *                                                        07770000
           MVC DDUNITYP,6(R1)  MOVE IN UNIT TYPE                        07780000
           B   DSVOL                                                    07790000
C03NOTIM   JOLERR 309,'''',#WORK,' ',#TKN,''' IS NOT YET IMPLEMENTED'   07800000
           B   C                                                        07810000
           TITLE 'DSNAME SET UP'                                        07820000
DSDSN      EQU *                                                        07830000
DSDSNAME   EQU *                                                        07840000
DSNAME     EQU *                                                        07850000
STARTDSN   EQU *                                                        07860000
           SPACE 3                                                      07870000
* NOW WE MUST FORM UP THE FULL DSNAME.EACH PART IS SEPERATED            07880000
*    BY A '.' OR THERE MAY BE'( )' AFTER                                07890000
           MVC CALLAREA(2),=C'||'                                 75311 07900000
           $CALL UJS60DSN      PROCESS DSNAME                     75311 07910000
           MVC DDPASSW,WORK+120 SHIFT PASSWORD IN                 80290 07920000
           B   C03DSRET(R15)                                      75311 07930000
C03DSRET   B   C03DSN1         STRAIGHT DSNAME                    75311 07940000
           B   C03DSN2         DSNAME + GENERATION NUMBER         75311 07950000
           B   C03DSN3         DSNAME + MEMBER                    75311 07960000
           B   C03DSN4         ERROR IN GENERATION NUMBER         75311 07970000
           B   C03DSN16        INVALID DSNAME                     75311 07980000
C03DSN1    BAL R10,C03STRDS    STORE DSN,GO TO C IF NOT STORED    75311 07990000
           MVC  DDMBR,WORK+100                                          08000000
           MVI DDTYPE,DDREALDS SET UP REAL DSN INDICATOR          75311 08010000
           CLI WORK,C'&&'    IS IT A TEMPORARY DSNAME ?           75311 08020000
           BNE C                                                  75311 08030000
           MVI DDTYPE,DDTEMPPS YES, SET TEMPORARY INDICATOR       75311 08040000
           B   C                                                  75311 08050000
           SPACE 3                                                75311 08060000
C03DSN2    BAL R10,C03STRDS    STORE DSN,GO TO C IF ERROR         75311 08070000
           MVC DDMBR,WORK+100                                     75311 08080000
           MVI DDTYPE,DDGDGREL SET RELATIVE FLAG                  75311 08090000
           CLC DDMBR+2(4),=C'0000' 0 GEN (IE RELATIVE)            75311 08100000
           BE  C               YES -> C                           75311 08110000
           CLI DDMBR+1,C' '    IS RELATIVE IND SET (+ | -)        75311 08120000
           BNE C               YES -> C                           75311 08130000
           MVI DDTYPE,DDGDGABS ABSOLUTE HERE, SET IT              75311 08140000
           B   C               GO TO C                            75311 08150000
           SPACE 3                                                75311 08160000
C03DSN3    BAL R10,C03STRDS    STORE DSN, GO TO C IF ERROR        75311 08170000
          MVI DDTYPE,DDMEMSPC  TURN ON REAL DSN WITH MEMBER       75311 08180000
           MVC DDMBR,WORK+100                                     75311 08190000
           CLI DDDSNAME,C'&&'  TEMPORARY DSNAME ?                 75311 08200000
           BNE C                                                  75311 08210000
           MVI DDTYPE,DDTEMPPO TURN ON TEMPORARY WITH MEMBER      75311 08220000
           B   C                                                  75311 08230000
C03DSN4    EQU *                                                  75311 08240000
GENERR   JOLERR 303,'ERROR IN GENERATION NUMBER'                        08250000
           B   C                                                        08260000
C03DSN16   JOLERR 313,'ERROR IN DSNAME'                           75311 08270000
           B   C                                                  75311 08280000
C03STRDS   CLI   DDDSNAME,C'%'      NODSN ALREADY CODED??               08290000
           BE    C                                                      08300000
           JOLSTOR 'DSNAME',DDDSNAME,#WORK                              08310000
           BR  R10                                                      08320000
           SPACE 3                                                      08330000
           TITLE 'DECODE DCB'                                           08340000
DSFIXED  EQU   *                                                  75128 08350000
DSUNDEF  EQU   *                                                 75128  08360000
DSVARIAB EQU   *                                                  75128 08370000
DSVAR    EQU   *                                                  75128 08380000
DSUNDEFI EQU   *                                                  75128 08390000
         MVI   #WORK+1,1      SET LENGTH INITIALLY TO ONE         75128 08400000
         MVC   WORK(1),TKN    SHIFT IN 1 CHAR (F OR V)            75128 08410000
C03NEXTZ GETTKN TKNCURR       GET NEXT TOKEN                      75128 08420000
         CLC   =C'BLOCKED ',TKN                                   75128 08430000
         BE    DSRECADD                                           75128 08440000
         CLC   =C'SPANNED ',TKN                                   75128 08450000
         BE    DSRECADD                                           75128 08460000
         CLC   =C'B ',TKN                                         75128 08470000
         BE    DSRECADD                                           75128 08480000
         CLC   =C'S ',TKN                                         75128 08490000
         BE    DSRECADD                                           75128 08500000
         CLC   =C'ASA ',TKN                                       75128 08510000
         BE    DSRECADD                                           75128 08520000
         CLC   =C'MACHINE ',TKN                                   75128 08530000
         BE    DSRECADD                                           75128 08540000
         CLC   =C'A ',TKN                                         75128 08550000
         BE    DSRECADD                                           75128 08560000
         CLC   =C'M ',TKN                                         75128 08570000
         BE    DSRECADD                                           75128 08580000
         JOLSTOR 'RECORD FORMAT',DDRECFM,#WORK                    75128 08590000
           OI  DDSPECT2,X'20'  TURN ON NODEFAULT BIT BECAUSE      75311 08600000
*                              RECFM WAS SPECIFIED BY ITSELF      75311 08610000
         B     C03TLNO                                            75311 08620000
DSRECADD STH   R1,TKNCURR     RESET TKN-CURRENT                   75128 08630000
         MVI   #TKN+1,1       SET LENGTH TO 1                     75128 08640000
         BAL   R14,CONCAT                                         75128 08650000
         B     C03NEXTZ       GET NEXT ITEM (IF ANY)              75128 08660000
ISARECFM   JOLSTOR 'RECORD FORMAT',DDRECFM,#TKN                         08670000
C03TLNO     LTR R15,R15                                                 08680000
           BNZ C                                                        08690000
           GETTKN LOCN=TKNCURR                 GET THE NEXT TOKEN       08700000
           CLI TKNTYPE,0                       NUMERIC                  08710000
           BNE C                               NOT NUMERIC,SO BUZZ OFF  08720000
****************************************************************** DASD 08730000
* PROBLEM HERE FOLKS IF THE CURRENT TOKEN IS NUMERIC AFTER       * DASD 08740000
* A RECORD FORMAT- YOU SEE THAT WE JUST HAPPEN TO HAVE SOME      * DASD 08750000
* KEY WORDS WHICH HAVE NUMERICS PRECEEDING THEM.  SOO AT THIS    * DASD 08760000
* POINT I CANNT REALLY TELL YOU WHO BELONGS WITH WHOM.           * DASD 08770000
* WHAT WE HAVE TO DO IS CHECK AHEAD 1,2 OR 3 TOKENS FOR KEY      * DASD 08780000
* WORDS WHICH MIGHT CAUSE US PROBLEMS                            * DASD 08790000
* THE FOLLOWING WAS REPORTED AS A PROBLEM                        * DASD 08800000
*                                                                * DASD 08810000
* DCL BUG DS WHY.ME RECFM=F 1,1 TRACKS;                          * DASD 08820000
* JOL SAID THAT 'TRACKS' WAS AND INVALID KEY WORD ----OK?        * DASD 08830000
****************************************************************** DASD 08840000
         STH    R1,TKNCURR         SAY CURRENT GUY                 DASD 08850000
         BCTR   R1,0           BACKOFF CURRENT TOKEN IN CASE OF A HDASD 08860000
         STH    R1,C03STKN         SAVE CURRENT TOKEN NUMBER       DASD 08870000
         LA     R10,C03FDKEY       BRANCH TO HERE ON A HIT         DASD 08880000
         GETTKN LOCN=TKNCURR       LETS LOOK AT NEXT GUY           DASD 08890000
         CLI    TKNTYPE,0          NUMERIC                         DASD 08900000
         BE     C03ITSOK           GOOD MOVE ON                    DASD 08910000
         CLI    TKN,C','           KEY WORD YET??                  DASD 08920000
         BE     C03LKEY2           NOPE LOOK AGAIN                 DASD 08930000
* SINGLE GUYS HERE--ONLY ONE TOKEN AHEAD OF IT                     DASD 08940000
         CLC    =C'PART ',TKN                                      DASD 08950000
         BER R10                                                   DASD 08960000
         CLC    =C'COPIES ',TKN                                    DASD 08970000
         BER R10                                                   DASD 08980000
         CLC    =C'UNITS ',TKN                                     DASD 08990000
         BER R10                                                   DASD 09000000
         CLC    =C'K ',TKN                                         DASD 09010000
         BER R10                                                   DASD 09020000
         CLC    =C'- ',TKN                                         DASD 09030000
         BER R10                                                   DASD 09040000
         CLC    =C'BYTES ',TKN                                     DASD 09050000
         BER R10                                                   DASD 09060000
         CLC    =C'RECS ',TKN                                      DASD 09070000
         BER R10                                                   DASD 09080000
         CLC    =C'RECORDS ',TKN                                   DASD 09090000
         BER R10                                                   DASD 09100000
         CLC    =C'BPI ',TKN                                       DASD 09110000
         BER R10                                                   DASD 09120000
         CLC    =C'DAYS ',TKN                                      DASD 09130000
         BER R10                                                   DASD 09140000
         CLC    =C'DAY ',TKN                                       DASD 09150000
         BER R10                                                   DASD 09160000
* OK NOW LOOK AT THE SPACE PARAMS    TRK, CYLS,....ECT             DASD 09170000
         LA     R15,C03SPTBL                                       DASD 09180000
C03SPL1  CLC    TKN(L'C03SPTBL),0(R15)                             DASD 09190000
         BER R10                                                   DASD 09200000
         LA     R15,L'C03SPTBL(R15)    INCR TO NEXT GUY            DASD 09210000
         C      R15,=A(C03SPTBE)       END??                       DASD 09220000
         BL     C03SPL1                                            DASD 09230000
         B      C03ITSOK               OK---ITS A GOOD LRECL/BLKSIZDASD 09240000
C03LKEY2 EQU    *    OK LETS LOOK AT NEXT TOKEN                    DASD 09250000
         GETTKN (R1)                                               DASD 09260000
         CLI    TKN,C','                                           DASD 09270000
         BER R10      TWO COMMAS IN A ROW ? 1,,1 TRKS ?            DASD 09280000
         CLI    TKNTYPE,0      NUMERIC??                           DASD 09290000
         BE     C03LKEY3       YES GO LOOK AGAIN                   DASD 09300000
C03CKTN2 EQU    *                                                  DASD 09310000
* DOUBLE TOKNES HERE                                               DASD 09320000
         CLC    =C'K ',TKN                                         DASD 09330000
         BER R10                                                   DASD 09340000
         CLC    =C'- ',TKN                                         DASD 09350000
         BER R10                                                   DASD 09360000
         CLC    =C'BYTES ',TKN                                     DASD 09370000
         BER R10                                                   DASD 09380000
         CLC    =C'RECS ',TKN                                      DASD 09390000
         BER R10                                                   DASD 09400000
         CLC    =C'RECORDS ',TKN                                   DASD 09410000
         BER R10                                                   DASD 09420000
         LA     R15,C03SPTBL                                       DASD 09430000
C03SPL2  CLC    TKN(L'C03SPTBL),0(R15)                             DASD 09440000
         BER R10                                                   DASD 09450000
         LA     R15,L'C03SPTBL(R15)    INCR TO NEXT GUY            DASD 09460000
         C      R15,=A(C03SPTBE)       END??                       DASD 09470000
         BL     C03SPL2                                            DASD 09480000
         B      C03ITSOK               OK---ITS A GOOD LRECL/BLKSIZDASD 09490000
C03LKEY3 EQU   *                                                   DASD 09500000
         GETTKN (R1)                                               DASD 09510000
         CLI    TKNTYPE,0                                          DASD 09520000
         BNE    C03CKTN2                                           DASD 09530000
         B      C03ITSOK    DONT KNOW WHAT THIS IS BUT IM GONE     DASD 09540000
C03FDKEY EQU    *                                                  DASD 09550000
         LH     R1,C03STKN         GET BACK OLD TOKEN NUMBER       DASD 09560000
         STH    R1,TKNCURR         SAY THIS IS THE CURRENT TOKEN   DASD 09570000
         B      C                  RETURN TO THE MAIN LAND         DASD 09580000
C03ITSOK EQU    *                                                  DASD 09590000
         LH     R1,C03STKN     RESTORE CURRENT TOKEN               DASD 09600000
         GETTKN (R1) RESTORE #TKN AS BEFORE THIS MESS              DASD 09610000
* THE NEXT TOKEN AFTER THE RECFM KEYWORD IS A NUMBER SO WE SHALL        09620000
*    HAVE A FIDDLE WITH IT                                              09630000
           STH R1,TKNCURR                                               09640000
           TNUM    #TKN                                                 09650000
           LTR R15,R15                                                  09660000
         BNZ   BLKERR                                             75128 09670000
         CH    R1,=H'32767'                                       75128 09680000
           BH  BLKERR                                                   09690000
         LR    R10,R1         SAVE NUMBER                         75128 09700000
           GETTKN LOCN=TKNCURR                 SEE IF A COMMA FOLLOWS,  09710000
           CLI     TKN,C','                    IE LRECL (OR BLKSIZE)    09720000
           BE  ISLRECL                                                  09730000
ONLYONE  EQU   *                                                  75128 09740000
           STH  R10,DDLRECL                                       80290 09750000
           CLI  DDRECFM,C'U'   RECFM U?                                 09760000
           BNE  C              NO,BACK TO MAIN LINE                     09770000
           MVC  DDBLKSZE,DDLRECL                                        09780000
           CLEAR DDLRECL                                                09790000
           B   C                               CONTINUE PROCESSING      09800000
ISLRECL    EQU *                                                        09810000
           STH R1,TKNCURR                                               09820000
           GETTKN LOCN=TKNCURR                 GET THE NEXT NUMBER(?)   09830000
           CLI TKNTYPE,0                                                09840000
         BNE   ONLYONE        ERROR WILL GET PICKED UP ELSEWHERE  75128 09850000
LRECSIZE   EQU *                                                        09860000
           STH R1,TKNCURR                                               09870000
           TNUM    #TKN                                                 09880000
           LTR R15,R15                                                  09890000
         BNZ   BLKERR         ERROR,DIDN'T CONVERT                75128 09900000
         CH    R1,=H'32767'                                       75128 09910000
           BH  BLKERR                                                   09920000
         CR    R10,R1         NOW TAKE THE SMALLEST               75128 09930000
*                                              AS BEING THE LRECL       09940000
           BH  STRLREC                                                  09950000
           LR  R9,R10                                                   09960000
         LR    R10,R1                                             75128 09970000
         LR    R1,R9                                              75128 09980000
STRLREC    EQU *                                                        09990000
* R1 CONTAINS THE SMALLER NUMBER, THE LRECL                       75128 10000000
           CLC =C'VS',DDRECFM                                           10010000
           BE  C03VBSWP                                                 10020000
           CLC =C'VBS',DDRECFM                                          10030000
           BE  C03VBSWP                                                 10040000
C03VSOK    EQU *                                                        10050000
           STH  R1,DDLRECL                                        80290 10060000
           STH  R10,DDBLKSZE                                      80290 10070000
           B   C                               CONTINUE PROCESSING      10080000
BLKERR   JOLERR 305,'ERROR IN BLOCKSIZE/RECORDSIZE:->32768'             10090000
           B   C                                                        10100000
C03VBSWP   LR  R9,R10                                                   10110000
         LR    R10,R1                                             75128 10120000
         LR    R1,R9                                              75128 10130000
           B   C03VSOK                                                  10140000
         BOX   'STORE RECSIZE AND BLOCKSIZE IF SPECIFIED'         75128 10150000
DSBLOCK  EQU   *                                                  75128 10160000
DSBLOCKS EQU   *                                                  75128 10170000
         JOLSTOR 'BLOCKSIZE',DDBLKSZE,#TKN,NUM                    75128 10180000
           OI  DDSPECT2,X'20'  TURN ON NODEFAULT BIT TOO          75311 10190000
         B     C                                                  75128 10200000
         SPACE 3                                                        10210000
DSRECSIZ EQU   *                                                  75128 10220000
DSRECORD EQU   *                                                  75128 10230000
         JOLSTOR 'RECORDSIZE',DDLRECL,#TKN,NUM                    75128 10240000
           OI  DDSPECT2,X'20'  TURN ON NODEFAULT BIT TOO          75311 10250000
         B     C                                                  75128 10260000
DSRECFM  EQU   *                                                        10270000
         OI  DDSPECT2,X'20'  TURN ON 'NODEFAULT' BIT                    10280000
         CLI  #TKN+1,1        RECFM (V B A) TYPE?                 75311 10290000
         BE   DSFIXED         MAYBE,SEE WHATS NEXT                75311 10300000
         B    ISARECFM        NO,STORE VBA ETC                    75311 10310000
           SPACE                                                        10320000
           TITLE 'FIX OPTCD'                                            10330000
DSOPTCD    DS  0H                                                       10340000
           JOLSTOR 'OPTCD',DDOPTCD,#TKN                                 10350000
           B  C                                                         10360000
           TITLE 'FIX JOL DATA BASE FUNCTIONS'                    J52   10361000
DSOWNER    EQU *                                                  J52   10362000
           CLI PHASE,C'P'                                         J52   10362100
           BNE C                 IGNORE IT                        J52   10362200
*          JOLSTOR 'OWNER',DDDDNAME,#TKN                          J52   10363000
           MVC DDDDNAME,TKN                                       J52   10363100
           B  C                                                   J52   10364000
DSMODEL    DS  0H                                                 J52   10365000
           CLI PHASE,C'P'                                         J52   10365100
           BNE C                 IGNORE IT                        J52   10365200
           MVC DDDSID(12),TKN    USES LARGER FIELD                J52   10366300
         B     C                                                  J52   10366400
DSVSAMXT   DS  0H                                                 J52   10366500
         CLI   PHASE,C'P'                                         J52   10366600
         BNE   C                 IGNORE IF NOT IN PREPROCESSOR    J52   10366700
*          JOLSTOR 'VSAMTXT',DDVSAMXT,#TKN                        J52   10366800
           MVC #DDVSAML(L'DDVSAMXT+2),#TKN                        J52   10366900
*        LA    R1,DDLEN+L'DDEXTRA+2   +2 FOR LENGTH DDVSAML       J52   10367000
         LA    R1,DDVSAMXT-DDOSVB    +2 FOR LENGTH DDVSAML        J52   10367100
         AH    R1,#DDVSAML       ADD LENGTH OF ACTUAL FIELD       J52   10367200
         STH   R1,DDOSVB                                          J52   10367300
*          B   C                                                  J52   10367400
         SPACE 3                                                  75128 10370000
           TITLE 'FIX VSAM KEYWORD'                               74256 10380000
DSVSAM     EQU *                                                  74256 10390000
         OI   DDSPECT2,X'01'    TURN ON VSAM                      75128 10400000
           B   C               BACK TO MAIN LOOP                  74256 10410000
DSPATH     DS  0H               STORE PATH NAME                   J60   10411007
         CLI   PHASE,C'P'                                         J60   10412001
         BE    C                 IGNORE IF NOT IN PREPROCESSOR    J60   10413002
*          JOLSTOR 'PATH   ',DDVSAMXT,#TKN                        J60   10414001
* THROUGHOUT JOL'S HISTORY, EFFORTS HAVE BEEN MADE TO HAVE NO     J60   10415007
* 'GETMAIN'S OTHER THAN 1 IN THE COMPILER.                              10416007
*   HOWEVER, WITH THE PATH, I FINALLY ADMIT DEFEAT!!  DEC 2, 2010 J60   10416107
* THE PATH WILL BE STORE IN A GOTTEN AREA!                        J60   10416207
*                                                                       10416307
         LA    R0,DDVSAMXT-DDOSVB    +2 FOR LENGTH DDVSAML        J60   10417007
         GETMAIN R,LV=(0)        JUST SAVE IT                     J60   10417107
         ST    R1,DDAEXTRA       SAVE THE ADDRESS                 J60   10419307
*        MVC #DDVSAML(L'DDVSAMXT+2),#TKN                          J60   10419407
         MVC   0(DDVSAMXT-DDOSVB,R1),#TKN  SAVE THE PATH          J60   10419507
* TEST IF DSNAME ALREADY CODED - GIVE ERROR                             10419601
         MVI   DDDSNAME,C'%'                                      J60   10419701
         SPACE 3                                                  J60   10419801
*SVSAM     EQU *                                                  J60   10419901
         MVI  DDTYPE,DDPATH     TURN ON PATH                      J60   10420001
           B   C               BACK TO MAIN LOOP                  J60   10420101
DSBIN      DS  0H               SET BINARY MODE FOR PATH          J60   10420209
DSTEXT     DS  0H               SET TEXT MODE FOR PATH            J60   10420309
           JOLSTOR 'PATH TYPE',DDFLTYPE,#TKN                      J60   10420409
           B   C               BACK TO MAIN LOOP                  J60   10420609
DSFORM     EQU *                                                  J60   10421001
* NEW FOR VERSION 3.0                                             75311 10430000
*                                                                 75311 10440000
* IF SOME-ONE CODES FORM=1, WE GENERATE 'S1', BUT IF THEY CODE    75311 10450000
*    FORM 'A1', WE POP IT OUT AS CODED.                           75311 10460000
*                                                                 75311 10470000
           CLI TKN,C''''       QUOTES AROUND FORM ?               75311 10480000
           BE  C03FQU          YES                                75311 10490000
* NO QUOTES HERE                                                  75311 10500000
           L   R1,AJOLGEN                                         75311 10510000
           USING GENDETS,R1                                       75311 10520000
         CLI   DDSYSCLS,C' '                             JOL30048 76200 10530000
         BNE   C03FORMO        BRANCH TO STORE FORM                SOCO 10540000
            MVC  DDSYSCLS,SPECFORM                                      10550000
           B   C03FORMO        STORE FORM NUMBER                  75311 10560000
           SPACE 1                                                75311 10570000
C03FQU     EQU *                                                  75311 10580000
* FORM KEYWORD FOUND                                              74256 10590000
           BAL R14,DROPQUOT    DROP QUOTES, IF ANY                75311 10600000
C03FORMO JOLSTOR 'FORM',DDSYSFRM,#TKN                             75128 10610000
           B   C               FORM DONE,BACK TO MAINLINE         74256 10620000
           TITLE 'FIX CYLOFL (CYLINDER OVERFLOW)'                       10630000
DSCYLOFL   JOLSTOR 'CYLOFL',DDOVERFL,#TKN,NUM  STORE AS REQUESTED 80290 10640000
           B   C               BACK TO MAIN LOOP MAN.                   10650000
           TITLE 'FIX KEY'                                              10660000
DSKEY      EQU *                                                        10670000
         JOLSTOR 'KEY LENGTH',DDKEYLEN,#TKN,255                   75128 10680000
           GETTKN TKNCURR                                               10690000
           CLI TKN,C','                                                 10700000
           BNE C                                                        10710000
           GETTKN (1)                                                   10720000
           STH R1,TKNCURR                                               10730000
DSKEYPOS EQU   *                                                        10740000
           JOLSTOR 'KEY POSITION',DDRKP,#TKN,NUM                  80290 10750000
           B  C                                                         10760000
DSKEYLEN EQU   *                                                        10770000
         JOLSTOR 'KEY LENGTH',DDKEYLEN,#TKN,255                   75128 10780000
         B     C                                                        10790000
           TITLE 'DECODE SUBSYS INFORMATION'                      87150 10800000
DSSUBSYS EQU   *                                                        10810000
         MVC   #WORK(L'TKN),#TKN                                  87150 10860000
SUBSLOOP GETTKN LOCN=TKNCURR                                      87150 10870000
         CLI   TKN,C','        MORE THAN 1 PARAMETER ?            87150 10880000
         BNE   STORSUBS                                           87150 10890000
         STH   R1,TKNCURR                                         87150 10900000
         BAL   R14,CONCAT      PUT COMMA IN                       87150 10901000
         GETTKN LOCN=TKNCURR                                      87150 10910000
         STH   R1,TKNCURR                                         87150 10920000
         BAL   R14,CONCAT                                         87150 10970000
         B     SUBSLOOP                                           87150 10980000
STORSUBS EQU   *                                                        10990000
         LA    R7,DDLENXTR                                              10991000
         USING DDLENXTR,R7                                              10992000
         JOLSTOR  'SUBSYS',DDSUBS,#WORK                                 11000000
         LTR   R15,R15                                                  11000100
         BNZ   C                                                        11000200
         MVC   #DDSUBS,#WORK                                            11000300
         DROP  R7                                                       11001000
         B     C                                                        11010000
         TITLE 'DECODE VOLUME INFORMATION'                              11031000
DSVOL    EQU   *                                                        11032000
DSVOLS   EQU   *                                                  75128 11033000
DSVOLUME EQU   *                                                        11034000
STARTVOL EQU   *                                                        11035000
         MVI   #TKN+1,6       SET LENGTH OF FIRST VOL=6           75128 11036000
           MVC #WORK(10),#TKN                                           11037000
VOLLOOP    GETTKN LOCN=TKNCURR                                          11038000
           CLI TKN,C','                        MORE THAN 1 VOLUME ?     11039000
           BNE STORVOLS                                                 11039100
           STH R1,TKNCURR                                               11039200
           GETTKN LOCN=TKNCURR                                          11039300
           STH R1,TKNCURR                                               11039400
           CLC #TKN,=H'6'                                               11039500
           BH VOLTOOBG                                                  11039600
CONTVOL     EQU *                                                       11039700
         MVI   #TKN+1,6       SET LENGTH OF SECOND VOL=6          75311 11039800
         BAL   R14,CONCAT                                         75128 11039900
           B   VOLLOOP                                                  11040000
STORVOLS   EQU *                                                        11040100
           JOLSTOR  'VOLUME',DDVOLUME,#WORK                             11040200
           B   C                                                        11040300
VOLTOOBG JOLERR 306,'VOLUME NAME''',#TKN,'''> 6 CHARACTERS-TRUNCATED'   11040400
           B CONTVOL                                                    11040500
         SPACE 3                                                        11040600
DSVOLSEQ EQU   *                                                        11050000
         JOLSTOR 'VOLUME SEQUENCE NUMBER',DDVOLSEQ,#TKN,NUM             11060000
         B     C                                                        11070000
           TITLE 'STORE DSORG'                                          11080000
DSORG    EQU   *                                                 75128  11090000
DSPS       EQU *                                                        11100000
DSPSU      EQU *                                                        11110000
DSIS       EQU *                                                        11120000
DSISU      EQU *                                                        11130000
DSPO       EQU *                                                        11140000
DSPOU      EQU *                                                        11150000
DSDA       EQU *                                                        11160000
DSDAU      EQU *                                                        11170000
DSSEQ      EQU *                                                        11180000
           JOLSTOR 'DATA SET ORGANISATION',DDDSORG,#TKN                 11190000
           B C                                                          11200000
          TITLE 'HANDLE VOLUME REFERENCE'                               11210000
DSVOLREF   EQU *                                                        11220000
* NEW FEATURE,VOLREF='SYS1.LINKLIB' IS ALLOWED    3 NOV,1974 C.CLA?5)   11230000
*    WHEN A RUN IS BEING DECODED,IT EXAMINES THE VOLREF FIELD FOR       11240000
*    A LITERAL STRING AND MAY GENERATE AN EXTRA DD-CARD FOR THE         11250000
*    VOLREF                                                             11260000
           MVI WORK,C'-'                  INDICATES TO A LATER          11270000
*                         ROUTINE THAT VOL REF WAS CODED                11280000
           LH R1,#TKN                                                   11290000
           LA R1,1(R1)                                                  11300000
           STH R1,#WORK                                                 11310000
           MVC WORK+1(40),TKN                                           11320000
           JOLSTOR 'VOLUME REFERENCE',DDVOLUME,#WORK                    11330000
           B C                                                          11340000
       FIX 'NO QUOTES'                                                  11350000
           TITLE 'UNIT DECODE'                                          11360000
* UNIT SLIGHTLY COMPLICATED BY THE FACT THAT IT MAY HAVE A KEYWORD      11370000
*    OR IT MAY NOT.                                                     11380000
* HOWEVER,THIS IS EASILY RESOLVED                                       11390000
DSUNIT     EQU *                                                        11400000
DSUNITS    EQU *                                                        11410000
STRUNIT    EQU *                                                        11420000
           MVC #WORK(12),#TKN                                           11430000
           GETTKN LOCN=TKNCURR                                          11440000
           CLI TKN,C'-'                                                 11450000
           BNE TUNITCOM        TEST IF UNIT FOLLOWED BY A','            11460000
         BAL   R14,CONCAT                                         75128 11470000
           GETTKN (R1)         GET NEXT TOKEN                     74256 11480000
           STH R1,TKNCURR                                               11490000
         BAL   R14,CONCAT                                         75128 11500000
           GETTKN (R1)         GET NEXT TOKEN                     74256 11510000
           SPACE 1                                                      11520000
TUNITCOM   EQU *                                                        11530000
           CLI TKN,C','                                                 11540000
           BNE C03STRUN        NO-> STORE UNIT                    74256 11550000
           STH R1,TKNCURR                                               11560000
           GETTKN (R1)         GET TKN AFTER ',',IE UNIT NUMBER   74256 11570000
           CLI TKNTYPE,0       <NUMBER>                           74256 11580000
           BE  C03VALUC        YES,VALID UNIT COUNT               74256 11590000
           CLC =C'P ',TKN      PARALLEL MOUNTING ?                74256 11600000
           BNE C03STRUN        NO, DON'T ISSUE AN ERROR THOUGH.   74256 11610000
*                              COULD BE SOMEONE CODED A UNIT,VOL  74256 11620000
*                              BUT ANYWAY,THE ERROR WILL SHOW UP  74256 11630000
*                              IF IT WASN'T A VALID KEYWORD       74256 11640000
*                              FOLLOWING.                         74256 11650000
C03VALUC   STH R1,TKNCURR      FIX IT UP SO WE WON'T GET IT AGAIN 74256 11660000
           JOLSTOR 'UNIT COUNT',DDUNITNO,#TKN STORE UNIT COUNT          11670000
C03STRUN   EQU *                                                  74256 11680000
           JOLSTOR 'UNIT',DDUNIT,#WORK                                  11690000
* SET UP DDUNITYP NOW, IF STORED                         JOL30030 76200 11700000
         LTR   R15,R15       DID WE STORE IT             JOL30030 76200 11710000
         BNZ   C              NO,SKIP THIS               JOL30030 7620/ 11720000
           SPACE 3                                                      11730000
         L     R1,AJOLGEN                                         75128 11740000
         L     R1,AGENUNIT-UJGENDET(R1)                           75128 11750000
           LM R14,R15,4(R1)                                             11760000
           L  R1,0(R1)                                                  11770000
TGENU9X    CLC DDUNIT,0(R1)                                             11780000
           BE  C03GOTGU                                                 11790000
           BXLE R1,R14,TGENU9X                                          11800000
         SPACE 1                                         JOL30030 76200 11810000
         L     R1,AJOLGEN                                JOL30030 76200 11820000
         USING GENDETS,R1                                JOL30030 76200 11830000
         L     R1,ADEVNAME    GET ADDRESS OF DEVNAMET    JOL30030 76200 11840000
         LTR   R1,R1          DID WE LOAD IT ?           JOL30030 76200 11850000
         BZ    C              NOPE                       JOL30030 76200 11860000
         L     R15,0(R1)     LOAD # ENTRIES IN TABLE     JOL30030 76200 11870000
         MH     R15,=H'12'   MULT                        JOL30030 76200 11880000
         LA    R1,4(R1)      SET TABLE START             JOL30030 76200 11890000
         AR    R15,R1         SET TABLE END              JOL30030 76200 11900000
         LA    R14,12         SET INCREMENT              JOL30030 76200 11910000
         CLC   DDUNIT,0(R1)   FIND UNIT IN TABLE         JOL30030 76200 11920000
         BE    C03UNDE        GOT IT                     JOL30030 76200 11930000
         BXLE  R1,R14,*-10    LOOP                       JOL30030 76200 11940000
         B     C              ERROR WILL BE PICKED UP LATER   30 76200  11950000
         SPACE 1                                         JOL30030 76200 11960000
C03UNDE    IFVALUE  DDUNITYP,C    SKIP IF ALREADY SET UP          76200 11970000
         MVI   DDUNITYP,X'80' SET UP DISK IND            JOL30030 76200 11980000
         CLI   10(R1),X'80'  IS DEVNAMET=TAPE            JOL30030 76200 11990000
         BNE   C                                         JOL30030 76200 12000000
         MVI   DDUNITYP,X'04' SET TO TAPE                JOL30030 76200 12010000
         LTR   R15,R15                                                  12020000
           B   C                                                        12030000
C03GOTGU EQU   *                                                        12040000
         MVC   DDUNIT,8(R1)   SWAP UNIT NAMES                           12050000
         MVC   DDUNITYP,16(R1)                                          12060000
         B     C                                                        12070000
         SPACE 2                                                        12080000
           TITLE 'DECODE MASS STORAGE FACILITY'                         12090000
DSMSSG     DS  0H                                                       12100000
           JOLSTOR 'MASS STORAGE',DDVOLUME,#TKN                   80290 12110000
           LTR R15,R15                                            80290 12120000
           BNZ C                                                        12130000
           OI  DDUNITQU,DDUNITM TURN ON MASS STORAGE BIT          80290 12140000
           B   C                                                        12150000
           SPACE 3                                                      12160000
DSQNAME    DS  0H                                                       12170000
           JOLSTOR 'QNAME',DDVOLUME,#TKN                          80290 12180000
           LTR R15,R15                                            80290 12190000
           BNZ C                                                        12200000
           OI  DDUNITQU,DDUNITQ TURN ON QNAME BIT                 80290 12210000
           MVI DDTYPE,DDSYSIN  TURN ON INDICATOR TO STOP VETS     80290 12220000
           MVI DDDSNAME,C'*'   TURN ON INDICATOR TO STOP VETS     82300 12230000
           B   C                                                        12240000
           SPACE 3                                                      12250000
         AGO   .C0301                                             75128 12260000
DSHIGH     EQU *                                                  74256 12270000
DSLOW      EQU *                                                  74256 12280000
DSDUAL     EQU *                                                  74256 12290000
* THIS CODE PROBABLY NEVER GETS EXECUTED,BUT ....                 74256 12300000
           MVC #WORK(6),#TKN                                      74256 12310000
           GETTKN TKNCURR                                         74256 12320000
*                                                                 74256 12330000
           CLC TKN(7),=C'DENSITY'                                       12340000
           BNE C03STRUN        GO STORE UNIT                      74256 12350000
           STH R1,TKNCURR                                               12360000
           GETTKN (R1)                                            74256 12370000
           CLC TKN(4),=C'TAPE'                                          12380000
           BNE C03STRUN        GO STORE UNIT                      74256 12390000
           STH R1,TKNCURR                                               12400000
           B   C03STRUN        GO STORE UNIT                      74256 12410000
.C0301   ANOP                                                     75128 12420000
           TITLE 'BUFFER KEYWORD DECODE'                                12430000
DSBUFNO    EQU *                                                        12440000
DSBUFFER   EQU *                                                        12450000
* THANK HEAVENS WE CAN'T GET INTO TOO MUCH TROUBLE WITH BUFFERS         12460000
           JOLSTOR 'BUFFER NUMBER',DDBUFNO,#TKN,255               74256 12470000
           B   C                                                        12480000
DSBUFNI    EQU *                                                        12490000
           JOLSTOR 'BUFNI PARAMETER',DDBUFNI,#TKN,255                   12500000
           B   DSVSAM                                                   12510000
DSBUFND    EQU *                                                        12520000
           JOLSTOR 'BUFND PARAMETER',DDBUFNO,#TKN,255                   12530000
           B   DSVSAM                                                   12540000
DSBUFL   EQU   *                                                        12550000
         JOLSTOR 'BUFFER LENGTH',DDBUFL,#TKN,NUM                        12560000
           B   C                                                        12570000
           TITLE 'DECODE SPACE '                                        12580000
DSABSTR  MVI DDCYLTRK,C'A'                                              12590000
DSSPACE    EQU *                                                        12600000
SPACE1OK EQU *                                                          12610000
         JOLSTOR 'PRIMARY SPACE',DDPRIM,#TKN,NUM                  75128 12620000
           LTR R15,R15                                                  12630000
           BNZ C                                                        12640000
           GETTKN LOCN=TKNCURR                                          12650000
           CLI TKN,C','                                                 12660000
           BNE SPACEQAL                                                 12670000
           STH R1,TKNCURR                                               12680000
           GETTKN (R1)                                            74256 12690000
* TEST FOR SPACE 10,,7                                                  12700000
           CLI  TKN,C','                                                12710000
           BNE  C03TS2                                                  12720000
           STH  R1,TKNCURR                                              12730000
           B    C03THIRD                                                12740000
C03TS2     EQU  *                                                       12750000
           CLI TKNTYPE,0                                                12760000
         BNE   SPACEQAL                                           75128 12770000
           STH R1,TKNCURR                                               12780000
         JOLSTOR 'SECONDARY SPACE',DDSEC,#TKN,NUM                 75128 12790000
          GETTKN LOCN=TKNCURR                                    75311  12800000
           CLI     TKN,C','                                             12810000
           BNE SPACEQAL                                                 12820000
* HERE THERE IS A THIRD SPACE                                           12830000
C03THIRD   STH R1,TKNCURR                                               12840000
           GETTKN (R1)                                            74256 12850000
           CLI TKNTYPE,0                       NUMERIC                  12860000
         BNE   SPACEQAL                                           75128 12870000
           STH R1,TKNCURR                                               12880000
         JOLSTOR 'DIRECTORY/INDEX SPACE',DDDIRECT,#TKN,NUM        75128 12890000
           GETTKN LOCN=TKNCURR                                          12900000
SPACEQAL   EQU *                                                        12910000
           LA  R15,C03SPTBL    SPACE TABLE CONSTANTS              74256 12920000
C03TSPC9   CLC TKN(L'C03SPTBL),0(R15) SPACE KEYWORD (TRK ETC?)    74256 12930000
           BE  C03GOTQ1               YES                         74256 12940000
           LA  R15,L'C03SPTBL(R15)    NOT YET,LOOK AT NEXT        74256 12950000
           C   R15,=A(C03SPTBE)                                   74256 12960000
           BL  C03TSPC9                                           74256 12970000
* NOT TRACKS OR ANYTHING SO MAKE IT BLANK AND LET THE VET ROUTINES      12980000
*         PUT SOMETHING APPROPRIATE THERE LATER                         12990000
           B   C                                                        13000000
C03GOTQ1   MVC DDCYLTRK,TKN           MOVE FIRST CHAR IN          74256 13010000
           STH R1,TKNCURR                                               13020000
           B   C                                                        13030000
         SPACE 3                                                        13040000
DSDIRECT EQU   *                                                  75128 13050000
DSDIR    EQU   *                                                  75128 13060000
         JOLSTOR 'DIRECTORY BLOCKS',DDDIRECT,#TKN,NUM             75128 13070000
         B     C                                                  75128 13080000
         SPACE 3                                                  75128 13090000
DSROUND  EQU   *                                                  75128 13100000
         OI    DDSPECTP,X'01'      TURN ON ROUND                  75128 13110000
         B     C                                                  75128 13120000
         SPACE 3                                                  75128 13130000
DSALX    OI    DDSPECTP,X'02'      TURN ON ALX                    75128 13140000
         B     C                                                  75128 13150000
DSMXIG   OI    DDSPECTP,X'04'      TURN ON MXIG                   75128 13160000
         B     C                                                  75128 13170000
         SPACE 3                                                        13180000
DSUNITNO EQU   *                                                        13190000
         CLI   TKN,C'P'       PARALLEL?                           75311 13200000
         BE    DSPARUN                                            75311 13210000
         JOLSTOR 'NO. OF UNITS',DDUNITNO,#TKN,NUM                 75128 13220000
         B     C                                                  75128 13230000
DSCONTIG EQU *                                                          13240000
         OI DDSPECT2,X'80'                                        75128 13250000
         B C                                                            13260000
           TITLE 'DECODE SIZE KEYWORD'                                  13270000
C03RECS  EQU   *                                                  75128 13280000
         GETTKN (R5)        GET THE ORIGINAL NUMBER AGAIN               13290000
DSSIZE     EQU *                                                        13300000
           JOLSTOR 'SIZE',DDSIZE,#TKN,NUM                         74256 13310000
           GETTKN LOCN=TKNCURR                                          13320000
           CLC     TKN(2),=C'K '                                        13330000
           BE   C03STRSQ                                                13340000
           CLC =C'BYTES ',TKN                                           13350000
           BE  C03STRSQ                                                 13360000
           CLC =C'RECS ',TKN                                            13370000
           BE   SKIP1                                                   13380000
          CLC =C'RECORDS ',TKN                                    75128 13390000
         BE    SKIP1       ONLY 1ST SIZE QUANTITY GIVEN US     75128    13400000
DSSIZE2  CLI   TKN,C'-'       N-N2 K CODED ?                      75128 13410000
         BNE   C              NO -> BACK TO MAIN LINE             75128 13420000
         GETTKN (R1)          GET NEXT SIZE                       75128 13430000
         STH   R1,TKNCURR     SAVE CURRENT POINTER                75128 13440000
         JOLSTOR 'SIZE',DDSIZE2,#TKN,NUM STORE SIZE2              75128 13450000
         GETTKN TKNCURR       GET NEXT TOKEN                      75128 13460000
         CLC   =C'K ',TKN                                         75128 13470000
         BE    C03STRSQ       YES                                 75128 13480000
C03TREC9   CLC =C'RECS ',TKN                                            13490000
         BE SKIP1                                                       13500000
         CLC  =C'RECORDS ',TKN                                          13510000
         BE SKIP1                                                       13520000
         CLC =C'BYTES ',TKN                                             13530000
         BNE  C                                                         13540000
C03STRSQ MVI   DDSIZEQ,C'K'                                       75128 13550000
         STH  R1,TKNCURR                                                13560000
         GETTKN (R1)                                                    13570000
         CLI  TKN,C'-'                                                  13580000
         BE   DSSIZE2                                                   13590000
         B    C03TREC9                                            75128 13600000
DSOF     EQU *   ********* KEYWORD, NOT NECESSARILY CODED AFTER         13610000
*               RECORDS NUMBER                                          13620000
        JOLSTOR  'MODAL-SIZE',DDAVREC,#TKN,NUM                          13630000
        B   C                                                           13640000
           TITLE 'DECODE LABEL'                                         13650000
DSLABEL    EQU *                                                        13660000
DSFILENO   JOLSTOR 'LABEL/FILENO',DDLABEL,#TKN,255                74256 13670000
           B   C                                                        13680000
DSRETAIN EQU   *                                                  75128 13690000
         LH  R1,TKNCURR                                                 13700000
         CLC   =C'UNTIL ',TKN                                     75128 13710000
         BE    C03TILL                                            75128 13720000
         CLC   =C'TILL ',TKN                                      75128 13730000
         BE    C03TILL                                            75128 13740000
           CLC =C'TIL ',TKN                                       75311 13750000
           BE  C03TILL                                            75311 13760000
         CLC   =C'FOR ',TKN                                       75128 13770000
         BE    C03FOR                                             75128 13780000
* ASSUME 'RETAIN 10 DAYS' HERE                                    75128 13790000
DSFOR    EQU   *                                                        13800000
C03RTPZ  JOLSTOR 'RETENTION PERIOD',DDEXPDT,#TKN,NUM              76200 13810000
         LTR   R15,R15                                   JOL30053 76200 13820000
         BNZ   C03TDX2       J                           JOL30053 76200 13830000
         MVI    DDRETPD,C'R'                             JOL30053 76200 13840000
C03TDX2  EQU   *                                                  75128 13850000
         GETTKN TKNCURR                                           75128 13860000
         CLC   =C'DAY ',TKN                                       75128 13870000
         BE    SKIP1                                              75128 13880000
         CLC   =C'DAYS ',TKN                                      75128 13890000
         BNE   C                                                  75128 13900000
         B   SKIP1    RESET TKNCURR ONE ABOVE                           13910000
C03FOR   GETTKN (R1)                                              75128 13920000
         STH   R1,TKNCURR                                         75128 13930000
         B     C03RTPZ                                            75128 13940000
         SPACE 3                                                  75128 13950000
C03TILL  GETTKN (R1)                                              75128 13960000
         STH   R1,TKNCURR                                         75128 13970000
DSUNTIL  EQU *                                                          13980000
DSTILL   EQU *                                                          13990000
         JOLSTOR 'EXPIRY DATE',DDEXPDT,#TKN              JOL30053 76200 14000000
         B     C03TDX2        TEST 'DAY' | 'DAYS' NOW             75128 14010000
           TITLE 'FIX NL,BLP ETC'                                       14020000
DSSL       LA  R1,0                                                     14030000
           B   C03STRLT                                                 14040000
DSNL       LA  R1,1                                                     14050000
           B   C03STRLT                                                 14060000
DSBLP      LA  R1,2                                                     14070000
           B   C03STRLT                                                 14080000
DSSUL      LA  R1,3                                                     14090000
           B   C03STRLT                                                 14100000
DSNSL      LA  R1,4                                                     14110000
           B   C03STRLT                                                 14120000
DSAL   EQU  *                                                           14130000
DSASCII    LA  R1,5                                                     14140000
           B   C03STRLT                                                 14150000
DSLTM    LA    R1,6                                               75128 14160000
         B     C03STRLT                                                 14170000
DSAUL    LA R1,7                                                        14180000
C03STRLT   STC R1,TKN                                                   14190000
           MVI #TKN+1,1                                                 14200000
           JOLSTOR 'LABEL TYPE',DDLABTYP,#TKN                           14210000
           B   C               BACK TO MAIN LINE                        14220000
         SPACE 3                                                        14230000
DSPRIVAT EQU   *                                                  75128 14240000
         OI    DDSPECTP,X'08'      TURN ON PRIVATE                75128 14250000
         B     C                                                  75128 14260000
         SPACE 3                                                  75128 14270000
DSREAD   EQU   *                                                  75128 14280000
DSREADON EQU   *                                                  75128 14290000
         OI    DDSPECTP,X'10'      TURN ON READONLY PROTECT       75128 14300000
           GETTKN TKNCURR      GET ITEM AFTER READ                75311 14310000
           CLC =C'ONLY ',TKN   'ONLY'                             75311 14320000
           BE  SKIP1           YES, IGNORE IT                     75311 14330000
         B     C                                                  75128 14340000
         SPACE 1                                                  75128 14350000
DSPROTEC EQU   *                                                  75128 14360000
         OI    DDSPECTP,X'20'      TURN ON DATA SET PROTECT (ALL) 75128 14370000
         B     C                                                  75128 14380000
         SPACE 3                                                  75128 14390000
DSNOCAT  EQU   *                                                  75128 14400000
         MVI   DDCATLGS,0                                         75128 14410000
           OI  PARMSRCH,X'02'  TELL US LATER THAT WE HAVE TO            14420000
*                              GENERATE A SPECIAL 'UJEINIT' STEP        14430000
*                              THAT SEARCHES THE SYSTEM CATALOG         14440000
*                              FOR THE DATA-SETS AT EXECUTE TIME        14450000
         B     C                                                  75128 14460000
         SPACE 3                                                  75128 14470000
* THE FOLLOWING SUPPORTS 'NODEFAULT' | 'NODEF', WHICH MEANS       75311 14480000
*    NO DEFAULTS TO BE MADE TO THE DDCARD.                        75311 14490000
DSNODEF    OI  DDSPECT2,X'20'  TURN ON DEFAULT                    75311 14500000
           B   C                                                  75311 14510000
           SPACE 3                                                75311 14520000
DSEXT    EQU   *                                                  75128 14530000
         MVI   C03DEXT,1      SET NON BLANK                       75128 14540000
         B     C                                                  75128 14550000
         SPACE 3                                                  75128 14560000
DSLIKE   MVC C03DLIKE,TKN    ***JOLSTOR CAN'T USE R13 AS A BASE **75128 14570000
         B     C                                                  75128 14580000
DSDSID   EQU   *                                                  75128 14590000
         JOLSTOR 'DSID',DDDSIDR,#TKN                              75128 14600000
         B     C                                                  75128 14610000
DSNORLSE   EQU  *                                                       14620000
DSNORELE   EQU  *                                                       14630000
         OI    DDSPECT2,X'02' TURN ON NORLSE FLAG                 75128 14640000
           B C                                                          14650000
DSRLSE   B     C              DUMMY FOR RLSE                     75128  14660000
           SPACE 3                                                      14670000
DSNONAME    EQU  *                                                      14680000
DSNODSN   CLI DDDSNAME,C' '    ALREADY GOT SOMETHING IN IT ?            14690000
          BNE C03STNDS                                                  14700000
          MVI DDDSNAME,C'%'                                             14710000
          B   C                                                         14720000
C03STNDS  JOLSTOR 'NO DSNAME ',DDDSNAME,#TKN                            14730000
          B   C                                                         14740000
          SPACE 3                                                       14750000
DSNODCB   CLI DDRECFM,C' '                                              14760000
          BNE C03STNRF                                                  14770000
          MVI DDRECFM,C'%'                                              14780000
          B   C                                                         14790000
C03STNRF  JOLSTOR 'NO DCB',DDRECFM,#TKN                                 14800000
          B   C                                                         14810000
          SPACE 3                                                       14820000
DSNOIO     EQU  *                                                       14830000
DSDUMMY    EQU *                                                        14840000
*          CLI DDDSNAME,C' '                                      74256 14850000
*          BNE C03STDUM                                           74256 14860000
          MVC DDDSNAME(6),=C'*DUMMY'                                    14870000
           B  C                                                         14880000
*03STDUM   JOLSTOR 'NO I0/DUMMY',DDDSNAME,#TKN                    74256 14890000
*          B   C                                                  74256 14900000
DSEROPT    LH  R1,TKNCURR      DUMMY                              75128 14910000
           BCTR  R1,0         -1 SO NEXT GET WILL GET ACCEPT ETC  75311 14920000
           B     SKIP1                                            75311 14930000
DSACCEPT EQU   *                                                  75128 14940000
         OI    DDSPECTP,X'40'      TURN ON ACCEPT ERRORS          75128 14950000
         B     C03CHKER       CHECK IF NEXT TKN='ERRORS'          75128 14960000
DSSKIP   EQU   *                                                  75128 14970000
         OI    DDSPECTP,X'80'      TURN ON SKIP ERRORS            75128 14980000
C03CHKER GETTKN TKNCURR       GET NEXT TOKEN                      75128 14990000
         CLC =C'ERRORS ',TKN  ='ERRORS'                           75128 15000000
         BNE   C              NO ->                               75128 15010000
         B     SKIP1                                              75128 15020000
DSCODE   JOLSTOR 'CODE',DDCODE,#TKN                                     15030000
         B   C                                                          15040000
         TITLE ' HANDLE OTHER SYSIN / SYSOUT PARAMETERS'          75128 15050000
DSREPLAC EQU   *                                                  75128 15060000
DSPRINTA EQU   *                                                  75128 15070000
DSJOLCRD EQU   *                                                  82300 15080000
DSPRINTN EQU   *                                                  75128 15090000
DSNOSPLT EQU   *                                                   DASD 15100000
DSPRINTO EQU   *                                                  75128 15110000
         CLI   DDTYPE,DDSYSIN  SYSIN DECLARE ?                    75128 15120000
         BE    C               YES,JUST IGNORE IT                 75128 15130000
         B     C03ERR         GIVE ERROR MSSGE                    75128 15140000
         SPACE 3                                                  75128 15150000
DSOUTLIM  EQU   *                                                       15160000
* WE USED TO HAVE (STILL DO IN FACT) A 'JOLSTOR' BUT IT                 15170000
* WONT STORE NUMBER INTO AL3 FIELDS, SO :                               15180000
          TNUM  #TKN                                                    15190000
          LTR   R15,R15                                                 15200000
          BNZ   DSOUTL2                                                 15210000
          ST    R1,DBL                                                  15220000
          CLC   DDOUTLIM,ZERO                                           15230000
          BNE   DSOUTL2                                                 15240000
          MVC   DDOUTLIM,DBL+1                                          15250000
          B     C                                                       15260000
DSOUTL2   JOLSTOR 'OUTLIM',DDOUTLIM,#TKN,NUM                            15270000
          B   C                                                         15280000
DSDEST   BAL   R14,DROPQUOT   DROP QUOTES (IF ANY) FROM TKN       75128 15290000
         JOLSTOR 'ROUTE/DEST',DDROUTE,#TKN                        75128 15300000
         B     C                                                  75128 15310000
DSFLASH  EQU *                                                          15320000
         MVI   #TKN+1,4                                                 15330000
         MVC   #WORK(10),#TKN                                           15340000
         GETTKN LOCN=TKNCURR                                            15350000
         CLI   TKN,C','                                                 15360000
         BNE   STORFLSH                                                 15370000
         STH   R1,TKNCURR                                               15380000
         BAL   R14,CONCAT                                               15390000
         GETTKN LOCN=TKNCURR                                            15400000
         STH   R1,TKNCURR                                               15410000
         MVI   #TKN+1,3                                                 15420000
         BAL   R14,CONCAT                                               15430000
STORFLSH JOLSTOR 'FLASH',DDFLASH,#WORK                                  15440000
         OI    DDUNITQU,DD3800                                          15450000
         B     C                                                  75128 15460000
DSCHARS  EQU *                                                          15470000
         MVI   #TKN+1,4                         SET LENGTH TO 4         15480000
         MVC   #WORK(10),#TKN                   MOVE TKN TO WORK        15490000
         GETTKN LOCN=TKNCURR                    GET NEXT TKN            15500000
         CLI   TKN,C','                         IS IT A COMMA           15510000
         BNE   STORCHRS                         NO GO STORE IT          15520000
         STH   R1,TKNCURR                      YES IT IS, SAVE ADDRESS  15530000
         BAL   R14,CONCAT                      SAVE COMMA               15540000
         GETTKN LOCN=TKNCURR                   GET 2ND PARM             15550000
         STH   R1,TKNCURR                      SAVE ADDRESS             15560000
         MVI   #TKN+1,4                        SET LENGTH TO 4          15570000
         BAL   R14,CONCAT                      SAVE IT                  15580000
         GETTKN LOCN=TKNCURR                    GET NEXT TKN            15590000
         CLI   TKN,C','                         IS IT A COMMA           15600000
         BNE   STORCHRS                         NO GO STORE IT          15610000
         STH   R1,TKNCURR                      YES IT IS, SAVE ADDRESS  15620000
         BAL   R14,CONCAT                      SAVE COMMA               15630000
         GETTKN LOCN=TKNCURR                   GET 3RD PARM             15640000
         STH   R1,TKNCURR                      SAVE ADDRESS             15650000
         MVI   #TKN+1,4                        SET LENGTH TO 4          15660000
         BAL   R14,CONCAT                      SAVE IT                  15670000
         GETTKN LOCN=TKNCURR                    GET NEXT TKN            15680000
         CLI   TKN,C','                         IS IT A COMMA           15690000
         BNE   STORCHRS                         NO GO STORE IT          15700000
         STH   R1,TKNCURR                      YES IT IS, SAVE ADDRESS  15710000
         BAL   R14,CONCAT                      SAVE COMMA               15720000
         GETTKN LOCN=TKNCURR                   GET 4TH PARM             15730000
         STH   R1,TKNCURR                      SAVE ADDRESS             15740000
         MVI   #TKN+1,4                        SET LENGTH TO 4          15750000
         BAL   R14,CONCAT                      SAVE IT                  15760000
STORCHRS JOLSTOR 'CHARS',DDCHARS,#WORK                                  15770000
         OI    DDUNITQU,DD3800                                          15780000
         B     C                                                  75128 15790000
DSMODIFY EQU *                                                          15800000
         MVI   #TKN+1,4                                                 15810000
         MVC   #WORK(10),#TKN                                           15820000
         GETTKN LOCN=TKNCURR                                            15830000
         CLI   TKN,C','                                                 15840000
         BNE   STORMDFY                                                 15850000
         STH   R1,TKNCURR                                               15860000
         BAL   R14,CONCAT                                               15870000
         GETTKN LOCN=TKNCURR                                            15880000
         STH   R1,TKNCURR                                               15890000
         MVI   #TKN+1,3                                                 15900000
         BAL   R14,CONCAT                                               15910000
STORMDFY JOLSTOR 'MODIFY',DDMODIFY,#WORK                          75128 15920000
         OI    DDUNITQU,DD3800                                          15930000
         B     C                                                  75128 15940000
DSBURST  MVI   #TKN+1,1              SET LENGTH TO 1              75128 15950000
         JOLSTOR 'BURST',DDBURST,#TKN                             75128 15960000
         OI    DDUNITQU,DD3800                                          15970000
         B     C                                                  75128 15980000
DSPROG   JOLSTOR 'SYSOUT PROGRAM',DDSYSPGM,#TKN                   75128 15990000
         B     C                                                  75128 16000000
DSUCS    JOLSTOR 'UCS',DDUCS,#TKN                                 75128 16010000
         B     C                                                  75128 16020000
DSFCB    JOLSTOR 'FCB',DDFCB,#TKN                                 75128 16030000
         B     C                                                  75128 16040000
DSVERIFY MVI   DDVERIFY,C'1'                                      75128 16050000
         B     C                                                  75128 16060000
DSALIGN  MVI   DDALIGN,C'1'                                       75128 16070000
         B     C                                                  75128 16080000
DSHOLD   OI    DDSPECT2,X'04'                                     75128 16090000
         B     C                                                  75128 16100000
DSFREE    EQU   *                                                       16110000
         GETTKN TKNCURR         GET NEXT TOKEN                          16120000
         CLI   TKN,C'='       = AFTER FREE ?                      75128 16130000
         BNE   C03FREEB       NOPE SEE IF FREE(CLOSE)             75128 16140000
         GETTKN (R1)          SKIP '='                            75128 16150000
         STH   R1,TKNCURR                                         75128 16160000
C03FREEB CLI   TKN,C'('       =( | FREE(CLOSE)                    75128 16170000
         BNE   C03FREEA       NO, SHOULD BE 'AT'|'CLOSE'|'END'    75128 16180000
         GETTKN (R1)          SKIP '()'                           75128 16190000
         STH   R1,TKNCURR                                         75128 16200000
C03FREEA EQU   *                                                        16210000
         CLC     =C'AT ',TKN                                            16220000
          BNE    C03FRCL                                                16230000
          GETTKN (R1)                                                   16240000
         STH R1,TKNCURR                                                 16250000
C03FRCL  CLC  =C'END ',TKN                                              16260000
          BE   C03ENDFR                                                 16270000
         CLC   =C'CLOSE ',TKN                                     75128 16280000
         BE    C03CLOSE                                           75128 16290000
         OI    DDSPECT2,X'08' FREE WITHOUT 'CLOSE' | 'END'        75128 16300000
         B     C                                                  75128 16310000
C03CLOSE OI    DDSPECT2,X'08'                                     75128 16320000
C03ENDFR   STH   R1,TKNCURR                                             16330000
         OI    DDSPECT2,X'10'  SET 'FREE AT END' BIT ON           80290 16340000
         B     C                                                  75128 16350000
DSDEN    JOLSTOR 'DEN',DDDENS,#TKN,NUM                            75128 16360000
         B     C                                                  75128 16370000
DSDIAGNS EQU   *                                                  75128 16380000
DSTRACE  OI    DDSPECT2,X'40'                                     75128 16390000
         B     C                                                  75128 16400000
DSMAXVOL JOLSTOR 'MAXVOL',DDMAXVOL,#TKN,NUM                       75128 16410000
         B     C                                                        16420000
         SPACE 1                                                  75128 16430000
DSDCBEXT EQU   *                                                  75128 16440000
         MVI   DDOSVB+1,DDLEN+L'DDEXTRA                           75128 16450000
         BAL   R14,DROPQUOT   DROP ''                             75128 16460000
         JOLSTOR 'DCB-EXTRA',DDEXTRA,#TKN                         75128 16470000
         B     C                                                  75128 16480000
         SPACE 1                                                  75128 16490000
DSPARUN  MVI   #TKN+1,1       SET LENGTH TO 1                     75128 16500000
         MVI  TKN,C'1'        SET IN CASE WE HAVE TO USE JOLSTOR        16510000
*                             TO GIVE ERROR MESSAGE                     16520000
         CLI   DDUNITNO,C' ' ANYTHING IN IT YET???                      16530000
         BNE   DSUNITNO      USE JOLSTOR FOR ERROR      JOL30041 76200  16540000
         MVI   DDUNITNO,C'P'                                            16550000
         GETTKN               TKNCURR                             75311 16560000
         CLC   =C'MOUNT ',TKN                                     75311 16570000
         BE    SKIP1                                              75311 16580000
         B     C                                                        16590000
         SPACE 1                                                        16600000
DSFOLD   MVI   #TKN+1,1    SET LENGTH TO '1'                      75311 16610000
         JOLSTOR              'FOLD',DDFOLD,#TKN                  75311 16620000
         B     C                                                  75311 16630000
         SPACE 1                                                  75128 16640000
C03ZAP1  JOLSTOR '        ',TKN,#TKN                                    16650000
         B     C                                                        16660000
C03ZAP2  JOLSTOR '        ',TKN,#TKN                                    16670000
         B     C                                                        16680000
*03ZAP3  JOLSTOR '        ',TKN,#TKN                                    16690002
*        B     C                                                        16700002
*03ZAP4  JOLSTOR '        ',TKN,#TKN                                    16710000
*        B     C                                                        16720000
*03ZAP5  JOLSTOR '        ',TKN,#TKN                                    16730000
*        B     C                                                        16740000
           SPACE 1                                                74256 16750000
C03SPTBL   DC  CL7'TRKS'                                          74256 16760000
         DC    CL7'CYLS'                                          75128 16770000
         DC    CL7'BLKS'                                          75128 16780000
         DC    CL7'TRK'                                           75128 16790000
         DC    CL7'CYL'                                           75128 16800000
         DC    CL7'BLK'                                           75128 16810000
         DC    CL7'BLOCKS'                                        75128 16820000
         DC    CL7'BLOCK'                                               16830000
         DC    CL7'TRACKS'                                        75128 16840000
         DC    CL7'TRACK'                                          DASD 16850000
C03SPTBE   EQU *                                                  74256 16860000
C03LA10  LA    R10,0          ****** MOVED TO DBL AND EXECUTED    75128 16870000
           LTORG                                                  74256 16880000
         CNOP  0,8                                                      16890000
           DC   S(*),S(*),S(*),S(*)                                     16900000
           DC   S(*),S(*),S(*),S(*)                                     16910000
           DC   S(*),S(*),S(*),S(*)                                     16920000
           DC   S(*),S(*),S(*),S(*)                                     16930000
           DC   S(*),S(*),S(*),S(*)                                     16940000
           DC   S(*),S(*),S(*),S(*)                                     16950000
           DC   S(*),S(*),S(*),S(*)                                     16960000
           DC   S(*),S(*),S(*),S(*)                                     16970000
           DC   S(*),S(*),S(*),S(*)                                     16980000
*          DC   S(*),S(*),S(*),S(*)                                     16990000
*          DC   S(*),S(*),S(*),S(*)                                     17000000
*          DC   S(*),S(*),S(*),S(*)                                     17010000
*          DC   S(*),S(*),S(*),S(*)                                     17020000
*          DC   S(*),S(*),S(*),S(*)                                     17030000
*          DC   S(*),S(*),S(*),S(*)                                     17040000
*          DC   S(*),S(*),S(*),S(*)                                     17050000
*          DC   S(*),S(*),S(*),S(*)                                     17060000
*          DC   S(*),S(*),S(*),S(*)                                     17070000
*          DC   S(*),S(*),S(*),S(*)                                     17080000
*          DC   S(*),S(*),S(*),S(*)                                     17090000
*          DC   S(*),S(*),S(*),S(*)                                     17100000
*          DC   S(*),S(*),S(*),S(*)                                     17110000
*          DC   S(*),S(*),S(*),S(*)                                     17120000
*          DC   S(*),S(*),S(*),S(*)                                     17130000
*        JOLSAVE CSECT=C03FKEY,BASE=R10                           86210 17130100
C03FKEY  CSECT                                                    86210 17130200
         USING C03FKEY,R10                                        86210 17130300
         SAVE  (14,12)                                            86210 17130400
         LR    R10,R15                                            86210 17130500
* BINARY SEARCH ROUTINE, JULY, 1986 BY C. V. CLARKE.                    17131000
*                                                                       17132000
* THE TABLE IS NOT A MULTIPLE OF TWO, AND THEREFORE WE WILL ASSUME      17133000
* THE TABLE HAS A MAXIMUM OF 256 ENTRIES, AND THAT THE MIDPOINT IS 128. 17134000
*                                                                       17135000
         LA    R1,128          BINARY MIDPOINT OF TABLE           86210 17136000
         LR    R6,R1           COPY TO R6                         86210 17137000
         AR    R6,R1           DOUBLE IT BECAUSE WE MISS 1ST ENTRY87150 17137100
         L     R8,CTBLEND      GET THE REAL END OF THE TABLE      86210 17138000
         L     R0,=V(UJC03KWD) LOAD ADDRESS OF TABLE TO REGISTER  86210 17139000
BINLOOP  SRL   R6,1            SET NEXT HALF POINT (DIV BY 2)     86210 17139100
         LR    R7,R1           COPY CURRENT POINT IN TABLE TO R7  86210 17139400
         SLL   R7,2            MULT BY 4                          86210 17139500
         LR    R14,R7          SAVE                               86210 17139600
         SLL   R7,1            MULT BY 2 (NOW 8 TIMES)            86210 17139700
         AR    R7,R14          NOW R7 CONTAINS 12 TIMES R6        86210 17139800
         AR    R7,R0           POINT TO REAL ADDRESS IN TABLE     86210 17139900
         CR    R7,R8           OVER THE END OF THE REAL TABLE ?   86210 17140000
         BNL   BINHIGH         TOO HIGH, NOT FOUND                87150 17140100
         CLC   0(8,R7),DBL     HAVE WE GOT THE KEYWORD?           86210 17140200
         BE    BINFOUND        YES                                86210 17140300
         BH    BINHIGH         TOO HIGH                           86210 17140400
BINLOW   SR    R15,R15         SET 'TOOHIGH_IND' OFF              86210 17140500
         AR    R1,R6           PREPARE TO LOOK HIGHER IN TABLE    86210 17140600
         B     BINTEND         CHECK IF END OF SEARCH             86210 17140700
BINHIGH  LA    R15,1           SET 'TOOHIGH_IND' ON               86210 17140800
         SR    R1,R6           PREPARE TO LOOK LOWER IN TABLE     86210 17140900
BINTEND  LTR   R6,R6           IF 0, END OF SEARCH, NOT FOUND     86210 17141000
         BNZ   BINLOOP         GO ROUND AGAIN ....                86210 17141100
         RETURN (14,12),,RC=0  DIDN'T FIND THE REQUIRED TOKEN     86210 17141200
BINFOUND LR    R15,R7          GOT THE REQUIRED TOKEN             86210 17141300
         RETURN (14,12),,RC=(15) GOT IT                           86210 17141400
         B     JRETN           ***********************            86210 17141500
CTBLEND  DC    A(UJCKEYE)      END OF THE TABLE ADDRESS           86210 17141600
         LTORG                                                          17141700
           DC   S(*),S(*),S(*),S(*)                                     17141800
           DC   S(*),S(*),S(*),S(*)                                     17141900
           DC   S(*),S(*),S(*),S(*)                                     17142000
           DC   S(*),S(*),S(*),S(*)                                     17142100
           DC   S(*),S(*),S(*),S(*)                                     17142200
* 30 MAY,1975  *****                                                    17142300
* THESE KEYWORDS USED TO BE IN A SEPERATELY ASSEMBLED CSECT             17150000
* THE FORMAT OF THE TABLE HAS BEEN CHANGED TO PUT THE MOST              17160000
*  FREQUENTLY USED KEY-WORDS UP THE FRONT OF THE TABLE                  17170000
* FURTHERMORE, AN INDICATOR IS NOW USED TO INDICATE WHETHER             17180000
*  THE WORD EXPECTS A VALUE (OR=) AFTER IT, OR WHETHER IT IS            17190000
*  A WORD WITH MEANING ON ITS OWN (EG DUMMY)                            17200000
*                                                                       17210000
* THE INDICATOR VALUES ARE:-                                            17220000
*                                                                       17230000
*        LAST 2 BITS INDICATE WHETHER A VALUE IS EXPECTED AFTER         17240000
*              THE KEYWORD OR NOT                                       17250000
*        01,1  = YES                                                    17260000
*        10,2  = NO                                                     17270000
*                                                                       17280000
*        NEXT 2 BITS INDICATE WHETHER KEYWORD IS ONLY FOR SYSOUT        17290000
*              OR NON SYSOUT FILE                                       17300000
*        01,4  = SYSOUT ONLY                                            17310000
*        10,8  = NON-SYSOUT ONLY                                        17320000
*                                                                       17330000
* VALUES THEREFORE ARE 1,2,3,4 IN DEC                                   17340000
*                                                                       17350000
         PRINT DATA                                                     17360000
UJC03KWD CSECT                                                          17370000
* TABLE OF KEYWORDS FOR UJC03DS, NOW IN ORDER OF USE FOR BINARY         17490000
*     SEARCH.   C. CLARKE, JULY 27, 1986                                17500000
         USING UJC03KWD,15                                              17510000
UJC03KWD CSECT                                                          17520000
         DC    CL8'&&         ',AL1(2+8),AL1(0),S(DSDSN)                17570000
         DC    CL8'ABE        ',AL1(2),AL1(0),S(C)  IGNORE        75311 17580000
         DC    CL8'ABEND      ',AL1(2),AL1(0),S(C)  IGNORE        75311 17590000
         DC    CL8'ABSTR      ',AL1(1),AL1(0),S(DSABSTR)                17600000
         DC    CL8'ACC       ',AL1(2),AL1(0),S(DSACCEPT)          75311 17610000
         DC    CL8'ACCEPT     ',AL1(2),AL1(0),S(DSACCEPT)               17620000
         DC    CL8'AL         ',AL1(2+8),AL1(0),S(DSAL)                 17630000
         DC    CL8'ALIGN      ',AL1(2+4),AL1(0),S(DSALIGN)              17640000
         DC    CL8'ALX        ',AL1(2),AL1(0),S(DSALX)                  17650000
         DC    CL8'ASCII      ',AL1(2),AL1(0),S(DSASCII)                17660000
         DC    CL8'AUL        ',AL1(2+8),AL1(0),S(DSAUL)                17670000
         DC    CL8'B          ',AL1(1),AL1(0),S(DSBLOCK)                17680000
*        DC    CL8'BIN        ',AL1(2),AL1(0),S(DSBIN)            J60   17681009
         DC    CL8'BINARY     ',AL1(2),AL1(0),S(DSBIN)            J60   17682009
         DC    CL8'BLKSIZE    ',AL1(1),AL1(0),S(DSBLOCK)                17690000
         DC    CL8'BLOCK      ',AL1(1),AL1(0),S(DSBLOCK)                17700000
         DC    CL8'BLOCKSIZE  ',AL1(1),AL1(0),S(DSBLOCK)                17710000
         DC    CL8'BLP        ',AL1(2+8),AL1(0),S(DSBLP)                17720000
         DC    CL8'BUFFER     ',AL1(1),AL1(0),S(DSBUFNO)                17730000
         DC    CL8'BUFFERS    ',AL1(1),AL1(0),S(DSBUFNO)                17740000
         DC    CL8'BUFFNO     ',AL1(1),AL1(0),S(DSBUFNO)          75311 17750000
         DC    CL8'BUFL       ',AL1(1),AL1(0),S(DSBUFL)                 17760000
         DC    CL8'BUFLEN     ',AL1(1),AL1(0),S(DSBUFL)                 17770000
         DC    CL8'BUFLENGTH  ',AL1(1),AL1(0),S(DSBUFL)                 17780000
         DC    CL8'BUFND      ',AL1(1),AL1(0),S(DSBUFND)                17790000
         DC    CL8'BUFNI      ',AL1(1),AL1(0),S(DSBUFNI)                17800000
         DC    CL8'BUFNO      ',AL1(1),AL1(0),S(DSBUFNO)                17810000
         DC    CL8'BURST      ',AL1(2+4),AL1(0),S(DSBURST)              17813000
         DC    CL8'CHARS      ',AL1(1+4),AL1(0),S(DSCHARS)              17815000
         DC    CL8'CODE       ',AL1(1+8),AL1(0),S(DSCODE)               17820000
         DC    CL8'CONTIG     ',AL1(2),AL1(0),S(DSCONTIG)               17830000
         DC    CL8'COPIES     ',AL1(1+4),AL1(0),S(DSCOPIES)             17840000
         DC    CL8'CYLOFL     ',AL1(1+8),AL1(0),S(DSCYLOFL)       75311 17850000
         DC    CL8'CYLOFLO    ',AL1(1+8),AL1(0),S(DSCYLOFL)             17860000
         DC    CL8'D          ',AL1(2),AL1(0),S(ISARECFM)               17870000
         DC    CL8'DA         ',AL1(2+8),AL1(0),S(DSORG)                17880000
         DC    CL8'DAU        ',AL1(2+8),AL1(0),S(DSORG)                17890000
         DC    CL8'DCBEXTRA   ',AL1(1),AL1(0),S(DSDCBEXT)               17900000
         DC    CL8'DEN        ',AL1(1+8),AL1(0),S(DSDEN)                17910000
         DC    CL8'DEST       ',AL1(1+4),AL1(0),S(DSDEST)               17920000
         DC    CL8'DIAGNS     ',AL1(1+8),AL1(0),S(DSDIAGNS)             17930000
         DC    CL8'DIR        ',AL1(1+8),AL1(0),S(DSDIR)                17940000
         DC    CL8'DM         ',AL1(2),AL1(0),S(ISARECFM)               17950000
         DC    CL8'DSN        ',AL1(1),AL1(0),S(DSDSN)                  17960000
         DC    CL8'DSNAME     ',AL1(1+8),AL1(0),S(DSDSN)                17970000
         DC    CL8'DSORG      ',AL1(1),AL1(0),S(DSORG)                  17980000
         DC    CL8'DUMMY      ',AL1(2),AL1(0),S(DSDUMMY)                17990000
         DC    CL8'EROPT      ',AL1(1),AL1(0),S(DSEROPT)                18000000
         DC    CL8'EXT        ',AL1(2),AL1(0),S(DSEXT)                  18010000
         DC    CL8'EXTERNAL   ',AL1(2),AL1(0),S(DSEXT)                  18020000
         DC    CL8'F          ',AL1(2),AL1(0),S(ISARECFM)               18030000
         DC    CL8'FA         ',AL1(2),AL1(0),S(ISARECFM)               18040000
         DC    CL8'FB         ',AL1(2),AL1(0),S(ISARECFM)               18050000
         DC    CL8'FBA        ',AL1(2),AL1(0),S(ISARECFM)               18060000
         DC    CL8'FBM        ',AL1(2),AL1(0),S(ISARECFM)               18070000
         DC    CL8'FBS        ',AL1(2),AL1(0),S(ISARECFM)               18080000
         DC    CL8'FBSA       ',AL1(2),AL1(0),S(ISARECFM)               18090000
         DC    CL8'FBSM       ',AL1(2),AL1(0),S(ISARECFM)               18100000
         DC    CL8'FBST       ',AL1(2),AL1(0),S(ISARECFM)               18110000
         DC    CL8'FBT        ',AL1(2),AL1(0),S(ISARECFM)         75311 18120000
         DC    CL8'FCB        ',AL1(1+4),AL1(0),S(DSFCB)                18130000
         DC    CL8'FILENO     ',AL1(1+8),AL1(0),S(DSLABEL)              18140000
         DC    CL8'FILESEQ    ',AL1(1+8),AL1(0),S(DSLABEL)              18150000
         DC    CL8'FIXED      ',AL1(2),AL1(0),S(DSFIXED)                18160000
         DC    CL8'FLASH      ',AL1(1+4),AL1(0),S(DSFLASH)              18161000
         DC    CL8'FM         ',AL1(2),AL1(0),S(ISARECFM)               18170000
         DC    CL8'FOLD       ',AL1(2+4),AL1(0),S(DSFOLD)         75311 18180000
         DC    CL8'FOR        ',AL1(1+8),AL1(0),S(DSFOR)                18190000
         DC    CL8'FORM       ',AL1(1+4),AL1(0),S(DSFORM)               18200000
         DC    CL8'FREE       ',AL1(2),AL1(0),S(DSFREE)                 18210000
         DC    CL8'FS         ',AL1(2),AL1(0),S(ISARECFM)               18220000
         DC    CL8'FST        ',AL1(2),AL1(0),S(ISARECFM)         75311 18230000
         DC    CL8'FST        ',AL1(2),AL1(0),S(ISARECFM)               18240000
         DC    CL8'FT         ',AL1(2),AL1(0),S(ISARECFM)               18250000
         DC    CL8'G          ',AL1(2),AL1(0),S(ISARECFM)               18260000
         DC    CL8'GROUP      ',AL1(1),AL1(0),S(DSMSSG)           80290 18270000
         DC    CL8'HOLD       ',AL1(2+4),AL1(0),S(DSHOLD)               18280000
*        DC    CL8'INDEXED    ',AL1(2+8),AL1(0),S(DSIND)           SOCO 18290000
*        DC    CL8'INDOFL     ',AL1(1+8),AL1(0),S(DSINDOFL)        SOCO 18300000
         DC    CL8'IS         ',AL1(2+8),AL1(0),S(DSORG)                18310000
         DC    CL8'ISU        ',AL1(2+8),AL1(0),S(DSORG)                18320000
         DC    CL8'JOL        ',AL1(2),AL1(0),S(DSJOLCRD)         82300 18330000
         DC    CL8'KEY        ',AL1(1+8),AL1(0),S(DSKEY)                18340000
         DC    CL8'KEYLEN     ',AL1(1+8),AL1(0),S(DSKEYLEN)             18350000
         DC    CL8'KEYPOS     ',AL1(1+8),AL1(0),S(DSKEYPOS)             18360000
         DC    CL8'KEYPOSN    ',AL1(1+8),AL1(0),S(DSKEYPOS)             18370000
         DC    CL8'LABEL      ',AL1(1+8),AL1(0),S(DSLABEL)              18380000
         DC    CL8'LIKE       ',AL1(1),AL1(0),S(DSLIKE)                 18390000
*        DC    CL8'LIMCT      ',AL1(1+8),AL1(0),S(DSLIMCT)              18400000
         DC    CL8'LRECL      ',AL1(1),AL1(0),S(DSRECSIZ)               18410000
         DC    CL8'LTM        ',AL1(2+8),AL1(0),S(DSLTM)          75128 18420000
         DC    CL8'MAXVOL     ',AL1(1+8),AL1(0),S(DSMAXVOL)             18430000
         DC    CL8'MAXVOLS    ',AL1(1+8),AL1(0),S(DSMAXVOL)       75311 18440000
         DC    CL8'MODEL      ',AL1(1+8),AL1(0),S(DSMODEL)         J52  18440100
         DC    CL8'MODIFY     ',AL1(1+4),AL1(0),S(DSMODIFY)             18441000
         DC    CL8'MSVGP      ',AL1(1),AL1(0),S(DSMSSG)           80290 18450000
         DC    CL8'MSVGRP     ',AL1(1),AL1(0),S(DSMSSG)           80290 18460000
         DC    CL8'MXIG       ',AL1(2),AL1(0),S(DSMXIG)                 18470000
         DC    CL8'NAME       ',AL1(1+8),AL1(0),S(DSDSN)                18480000
*        DC    CL8'NCP        ',AL1(1+8),AL1(0),S(DSNCP)           SOCO 18490000
         DC    CL8'NL         ',AL1(2+8),AL1(0),S(DSNL)                 18500000
         DC    CL8'NOCAT      ',AL1(2+8),AL1(0),S(DSNOCAT)              18510000
         DC    CL8'NOCATLG    ',AL1(2+8),AL1(0),S(DSNOCAT)              18520000
         DC    CL8'NODCB      ',AL1(2),AL1(0),S(DSNODCB)                18530000
         DC    CL8'NODEF      ',AL1(2),AL1(0),S(DSNODEF)          75311 18540000
         DC    CL8'NODEFAULT  ',AL1(2),AL1(0),S(DSNODEF)          75311 18550000
         DC    CL8'NODSN      ',AL1(2+8),AL1(0),S(DSNODSN)              18560000
         DC    CL8'NODSNAME   ',AL1(2+8),AL1(0),S(DSNODSN)        75311 18570000
         DC    CL8'NOIO       ',AL1(2),AL1(0),S(DSDUMMY)                18580000
*        DC    CL8'NOMOVE     ',AL1(2),AL1(0),S(DSNOMOVE)          SOCO 18590000
         DC    CL8'NONAME     ',AL1(2+8),AL1(0),S(DSNODSN)        75311 18600000
*        DC    CL8'NOOPT      ',AL1(2),AL1(0),S(DSNOOPT)           SOCO 18610000
         DC    CL8'NORELEASE  ',AL1(2+8),AL1(0),S(DSNORLSE)             18620000
         DC    CL8'NORLSE     ',AL1(2),AL1(0),S(DSNORLSE)               18630000
         DC    CL8'NOSPLIT    ',AL1(2),AL1(0),S(DSNOSPLT)          DASD 18640000
         DC    CL8'NSL        ',AL1(2+8),AL1(0),S(DSNSL)          75311 18650000
         DC    CL8'OF         ',AL1(1),AL1(0),S(DSOF)  *****            18660000
         DC    CL8'OPTCD      ',AL1(1+8),AL1(0),S(DSOPTCD)              18670000
         DC    CL8'OUTLIM     ',AL1(1+4),AL1(0),S(DSOUTLIM)             18680000
         DC    CL8'OWNER      ',AL1(1+8),AL1(0),S(DSOWNER)         J52  18681000
         DC    CL8'PARALLEL   ',AL1(2+8),AL1(0),S(DSPARUN)        75128 18690000
*        DC    CL8'PARTITIONED',AL1(2+8),AL1(0),S(DSPART)          SOCO 18700000
         DC    CL8'PATH       ',AL1(1+8),AL1(0),S(DSPATH)           J60 18701001
         DC    CL8'PGM        ',AL1(1+4),AL1(0),S(DSPROG)               18710000
         DC    CL8'PO         ',AL1(2+8),AL1(0),S(DSORG)                18720000
         DC    CL8'POSITION   ',AL1(1+8),AL1(0),S(DSLABEL)        75128 18730000
         DC    CL8'POU        ',AL1(2+8),AL1(0),S(DSORG)                18740000
         DC    CL8'PRINTALL   ',AL1(2),AL1(0),S(DSPRINTA)               18750000
         DC    CL8'PRINTNONE  ',AL1(2),AL1(0),S(DSPRINTN)               18760000
         DC    CL8'PRINTOFF   ',AL1(2),AL1(0),S(DSPRINTO)               18770000
         DC    CL8'PRIVATE    ',AL1(2+8),AL1(0),S(DSPRIVAT)             18780000
*        DC    CL8'PROFILE    ',AL1(1+4),AL1(0),S(DSPROFIL)        SOCO 18790000
         DC    CL8'PROG       ',AL1(1+4),AL1(0),S(DSPROG)               18800000
         DC    CL8'PROTECT    ',AL1(2+8),AL1(0),S(DSPROTEC)             18810000
         DC    CL8'PS         ',AL1(2+8),AL1(0),S(DSORG)                18820000
         DC    CL8'PSU        ',AL1(2+8),AL1(0),S(DSORG)                18830000
         DC    CL8'QNAME      ',AL1(1),AL1(0),S(DSQNAME)           SOCO 18840000
         DC    CL8'R          ',AL1(2),AL1(0),S(ISARECFM)               18850000
         DC    CL8'READ       ',AL1(2+8),AL1(0),S(DSREAD)               18860000
         DC    CL8'READONLY   ',AL1(2+8),AL1(0),S(DSREAD)               18870000
         DC    CL8'RECFM      ',AL1(1),AL1(0),S(DSRECFM)          75311 18880000
         DC    CL8'RECORDSIZE ',AL1(1),AL1(0),S(DSRECSIZ)               18890000
         DC    CL8'RECSIZE    ',AL1(1),AL1(0),S(DSRECSIZ)               18900000
         DC    CL8'REPLACE    ',AL1(2),AL1(0),S(DSREPLAC)               18910000
         DC    CL8'RETAIN     ',AL1(1+8),AL1(0),S(DSRETAIN)             18920000
         DC    CL8'RLSE       ',AL1(2),AL1(0),S(DSRLSE)                 18930000
         DC    CL8'ROUND      ',AL1(2),AL1(0),S(DSROUND)                18940000
         DC    CL8'ROUTE      ',AL1(1+4),AL1(0),S(DSDEST)               18950000
         DC    CL8'S          ',AL1(2),AL1(0),S(ISARECFM)               18960000
         DC    CL8'SEQ        ',AL1(2+8),AL1(0),S(DSSEQ)                18970000
         DC    CL8'SEQUENTIAL ',AL1(2+8),AL1(0),S(DSSEQ)                18980000
         DC    CL8'SIZE       ',AL1(1),AL1(0),S(DSSIZE)                 18990000
         DC    CL8'SKIP       ',AL1(2),AL1(0),S(DSSKIP)                 19000000
         DC    CL8'SKP       ',AL1(2),AL1(0),S(DSSKIP)            75311 19010000
         DC    CL8'SL         ',AL1(2+8),AL1(0),S(DSSL)                 19020000
         DC    CL8'SPACE      ',AL1(1),AL1(0),S(DSSPACE)                19030000
         DC    CL8'SUBSYS     ',AL1(1),AL1(0),S(DSSUBSYS)         87150 19040000
         DC    CL8'SUL        ',AL1(2+8),AL1(0),S(DSSUL)                19041000
         DC    CL8'TEXT       ',AL1(2),AL1(0),S(DSTEXT)           J60   19042009
         DC    CL8'TIL        ',AL1(1+8),AL1(0),S(DSTILL)         75311 19050000
         DC    CL8'TILL       ',AL1(1+8),AL1(0),S(DSTILL)               19060000
         DC    CL8'TRACE      ',AL1(2+8),AL1(0),S(DSTRACE)              19070000
*        DC    CL8'TRKOFL     ',AL1(1+8),AL1(0),S(DSTRKOFL)        SOCO 19080000
         DC    CL8'U          ',AL1(2),AL1(0),S(ISARECFM)               19090000
         DC    CL8'UA         ',AL1(2),AL1(0),S(ISARECFM)               19100000
         DC    CL8'UCOUNT     ',AL1(1),AL1(0),S(DSUNITNO)   30034 76200 19110000
         DC    CL8'UCS        ',AL1(1+4),AL1(0),S(DSUCS)                19120000
         DC    CL8'UM         ',AL1(2),AL1(0),S(ISARECFM)               19130000
         DC    CL8'UNDEF      ',AL1(2),AL1(0),S(DSUNDEF)                19140000
         DC    CL8'UNDEFINED  ',AL1(2),AL1(0),S(DSUNDEF)                19150000
         DC    CL8'UNIT       ',AL1(1),AL1(0),S(DSUNIT)           76200 19160000
         DC    CL8'UNITNO     ',AL1(1),AL1(0),S(DSUNITNO)   30034 76200 19170000
         DC    CL8'UNITS      ',AL1(1),AL1(0),S(DSUNIT)           76200 19180000
*        DC    CL8'UNMOVEABLE ',AL1(2),AL1(0),S(DSNOMOVE)          SOCO 19190000
         DC    CL8'UNTIL      ',AL1(1+8),AL1(0),S(DSUNTIL)              19200000
         DC    CL8'UT         ',AL1(2),AL1(0),S(ISARECFM)               19210000
         DC    CL8'UTA        ',AL1(2),AL1(0),S(ISARECFM)               19220000
         DC    CL8'UTM        ',AL1(2),AL1(0),S(ISARECFM)               19230000
         DC    CL8'V          ',AL1(2),AL1(0),S(ISARECFM)               19240000
         DC    CL8'VA         ',AL1(2),AL1(0),S(ISARECFM)               19250000
         DC    CL8'VAR        ',AL1(2),AL1(0),S(DSVARIAB)               19260000
         DC    CL8'VARIABLE   ',AL1(2),AL1(0),S(DSVARIAB)               19270000
         DC    CL8'VB         ',AL1(2),AL1(0),S(ISARECFM)               19280000
         DC    CL8'VBA        ',AL1(2),AL1(0),S(ISARECFM)               19290000
         DC    CL8'VBM        ',AL1(2),AL1(0),S(ISARECFM)         75311 19300000
         DC    CL8'VBS        ',AL1(2),AL1(0),S(ISARECFM)               19310000
         DC    CL8'VBSA       ',AL1(2),AL1(0),S(ISARECFM)               19320000
         DC    CL8'VBSM       ',AL1(2),AL1(0),S(ISARECFM)               19330000
         DC    CL8'VBST       ',AL1(2),AL1(0),S(ISARECFM)               19340000
         DC    CL8'VBT        ',AL1(2),AL1(0),S(ISARECFM)               19350000
         DC    CL8'VERIFY     ',AL1(2+4),AL1(0),S(DSVERIFY)             19360000
         DC    CL8'VM         ',AL1(2),AL1(0),S(ISARECFM)               19370000
         DC    CL8'VOL        ',AL1(1+8),AL1(0),S(DSVOL)                19380000
         DC    CL8'VOLCOUNT   ',AL1(1+8),AL1(0),S(DSMAXVOL)       75128 19390000
         DC    CL8'VOLREF     ',AL1(1+8),AL1(0),S(DSVOLREF)             19400000
         DC    CL8'VOLS       ',AL1(1+8),AL1(0),S(DSVOL)                19410000
         DC    CL8'VOLSEQ     ',AL1(1+8),AL1(0),S(DSVOLSEQ)             19420000
         DC    CL8'VOLUME     ',AL1(1+8),AL1(0),S(DSVOL)                19430000
         DC    CL8'VOLUMES    ',AL1(1+8),AL1(0),S(DSVOL)                19440000
         DC    CL8'VS         ',AL1(2),AL1(0),S(ISARECFM)               19450000
         DC    CL8'VSAM       ',AL1(2+8),AL1(0),S(DSVSAM)               19460000
         DC    CL8'VSAMTXT    ',AL1(1+8),AL1(0),S(DSVSAMXT)       J52   19461000
         DC    CL8'VSEQ       ',AL1(1+8),AL1(0),S(DSVOLSEQ)       75128 19470000
         DC    CL8'VST        ',AL1(2),AL1(0),S(ISARECFM)         75311 19480000
         DC    CL8'VT         ',AL1(2),AL1(0),S(ISARECFM)               19490000
UJCKEYE  EQU   *              END OF KEYWORD TABLE                86200 19500000
         DC    XL8'FFFFFFFFFF',AL1(2),AL1(0),S(0)                 87150 19510000
         END                                                            19640000
