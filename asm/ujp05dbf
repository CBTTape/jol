UJP05DBF TITLE 'JOL PREPROC INSTRUCTION TO GET D/S INFO FROM JOL /BASE' 00010000
* JOL COPYRIGHT CCS-JOL 1989                                            00020000
* REFER TO INSTRUCTIONS ON COPYRIGHT NOTICE FORM NO CCS-JOL             00030000
           SPACE 3                                                      00040000
*                   J             000000            L                   00050000
*                   J            0      0           L                   00060000
*                   J           0        0          L                   00070000
*                   J          0          0         L                   00080000
*                   J         0            0        L                   00090000
*                   J         0            0        L                   00100000
*                   J         0            0        L                   00110000
*                   J         0            0        L                   00120000
*                   J         0            0        L                   00130000
*                   J         0            0        L                   00140000
*                   J         0            0        L                   00150000
*        J          J         0            0        L                   00160000
*         J        J           0          0         L                   00170000
*          J      J             0        0          L                   00180000
*           J    J               0      0           L                   00190000
*            JJJJ                 000000            LLLLLLLLLLL         00200000
         PUNCH ' PAGE UJP05DBF '                                        00210000
         PRINT OFF                                                      00220000
         COPY JOLCOM                                                    00230000
         PRINT ON                                                       00240000
JOLCOM   DSECT                                                          00250000
         ORG   #WORK                                                    00260000
#DSN     DS    H                                                        00270000
DSN      DS    CL44                                                     00280000
         ORG   WORK+100                                                 00290000
MBRNAME  DS    CL8                                                      00300000
         ORG                                                            00310000
P05WORK  DSECT                                                    J50   00320000
P05SAV   DS    18F                                                J50   00330000
P05FLAG1 DS    X                                                  J50   00340000
P05F1MDL EQU   X'80'                                              J50   00350000
         DS    3X                                                 J50   00360000
P05MODEL DS    CL12              MODEL NAME                       J50   00370000
*                                                                 J51   00380000
* DATA BASE RECORD IS READ HERE                                   J51   00390000
*                                                                 J51   00400000
P05DBREC DS    CL256             RECORD READ HERE FROM DATA BASE  J50   00410000
         DS    CL256             VSAM INFO MAY FOLLOW             J52   00420000
*        ORG   P05DBREC          VSAM RECORDS FOLLOW HERE         J50   00430000
*                                                                 J51   00440000
*  VSAM SECTION ....................................................... 00450000
*                                                                 J51   00460000
CLFREECI DS    CL2             /* %                                     00470000
CLFREECA DS    CL2             /* % OR 0                                00480000
CLUNIQUE DS    CL1             /*    UNIQUE SPACE                       00490000
*                                                                       00500000
*CLPASSRD DS    CL8             /* PASSWORD (READ)                      00510000
*CLPASSWR DS    CL8             /* PASSWORD (WRITE)                     00520000
CLATTEMP DS    CL1             /* ATTEMPTS                              00530000
*                                                                       00540000
*CLRETPD  DS    CL1                                                     00550000
*CLEXPDT  DS    CL5                                                     00560000
*                                                                       00570000
*CLBUFFSP DS    CL1             /*    BUFFER SPACE                      00580000
CLCODE   DS    CL1                                                      00590000
CLWAIT   DS    CL1             /*    STAGE WAIT                         00600000
CLERASE  DS    CL1             /*    YES OR NO                          00610000
CLIMBED  DS    CL1             /*    YES OR NO                          00620000
CLINDEXD DS    CL1             /*    YES, NO OR NUMBERED                00630000
CLKEYRNG DS    CL5                                                      00640000
*CLRKP    DS    CL3                                                     00650000
*CLKEYLEN DS    CL3                                                     00660000
CLORDERD DS    CL1             /*    YES OR NO                          00670000
CLREPLIC DS    CL1             /*    YES OR NO                          00680000
CLREUSE  DS    CL1             /*    YES OR NO                          00690000
CLSPAN   DS    CL1             /*    YES OR NO                          00700000
CLSPEED  DS    CL1             /*    R=RECOVERY                         00710000
CLSTAGE  DS    CL1             /*    STAGE, BIND OR CYL FAULT           00720000
*                                                                       00730000
*                                                                       00740000
* VSAM DATA DETAILS                                                     00750000
*                                                                       00760000
*                                                                       00770000
* START OF NEW SECTION .... VSAM DATA SECTION .......................   00780000
*                                                                       00790000
DTNAME   DS    CL44            /* DATA NAME                             00800000
*                                                                       00810000
DTVOLUME DS    CL42            /* ENOUGH FOR 6 VOLS             *       00820000
*                                                                       00830000
DTPRIM   DS    CL5                                                      00840000
DTSEC    DS    CL5                                                      00850000
DTCISIZE DS    CL5                                                      00860000
*DTNORLSE DS    CL1             /*    NORLSE                     *      00870000
DTCYLTRK DS    CL1             /* CYL TRK OR REC                *       00880000
DTFREECI DS    CL2             /* %                             *       00890000
DTFREECA DS    CL2             /* % OR 0                        *       00900000
DTUNIQUE DS    CL1             /*    UNIQUE SPACE               *       00910000
*                                                                       00920000
*DTPASSRD DS    CL8             /* PASSWORD (READ)               *      00930000
*DTPASSWR DS    CL8             /* PASSWORD (WRITE)              *      00940000
DTATTEMP DS    CL1             /* ATTEMPTS                      *       00950000
*                                                                       00960000
DTRETPD  DS    CL1                                                      00970000
DTEXPDT  DS    CL5                                                      00980000
*                                                                       00990000
DTBUFFSP DS    CL1             /*    BUFFER SPACE               *       01000000
DTCODE   DS    CL1                                                      01010000
DTWAIT   DS    CL1             /*    STAGE WAIT                 *       01020000
DTERASE  DS    CL1             /*    YES OR NO                  *       01030000
DTIMBED  DS    CL1             /*    YES OR NO                          01040000
DTINDEXD DS    CL1             /*    YES, NO OR NUMBERED                01050000
DTKEYRNG DS    CL5                                                      01060000
DTRKP    DS    CL3                                                      01070000
DTKEYLEN DS    CL3                                                      01080000
DTORDERD DS    CL1             /*    YES OR NO                          01090000
DTREPLIC DS    CL1             /*    YES OR NO                          01100000
DTREUSE  DS    CL1             /*    YES OR NO                          01110000
DTSPAN   DS    CL1             /*    YES OR NO                          01120000
DTSPEED  DS    CL1             /*    R=RECOVERY                         01130000
DTSTAGE  DS    CL1             /*    STAGE, BIND OR CYL FAULT           01140000
*                                                                       01150000
*                                                                       01160000
* VSAM INDEX DETAILS                                                    01170000
*                                                                       01180000
*                                                                       01190000
* START OF NEW SECTION                                                  01200000
*                                                                       01210000
INNAME   DS    CL44            /* CLUSTER DATA SET NAME.                01220000
INVOLUME DS    CL42            /* ENOUGH FOR 6 VOLS             *       01230000
*                                                                       01240000
INPRIM   DS    CL5                                                      01250000
INSEC    DS    CL5                                                      01260000
INCISIZE DS    CL5                                                      01270000
INNORLSE DS    CL1             /*    NORLSE                     *       01280000
INCYLTRK DS    CL1             /* CYL TRK OR REC                *       01290000
INFREECI DS    CL2             /* %                             *       01300000
INFREECA DS    CL2             /* % OR 0                        *       01310000
INUNIQUE DS    CL1             /*    UNIQUE SPACE               *       01320000
*                                                                       01330000
*INPASSRD DS    CL8             /* PASSWORD (READ)               *      01340000
*INPASSWR DS    CL8             /* PASSWORD (WRITE)              *      01350000
INATTEMP DS    CL1             /* ATTEMPTS                      *       01360000
*                                                                       01370000
*INRETPD  DS    CL1                                                     01380000
*INEXPDT  DS    CL5                                                     01390000
*                                                                       01400000
INBUFFSP DS    CL1             /*    BUFFER SPACE               *       01410000
INCODE   DS    CL1                                                      01420000
INWAIT   DS    CL1             /*    STAGE WAIT                 *       01430000
INERASE  DS    CL1             /*    YES OR NO                  *       01440000
INIMBED  DS    CL1             /*    YES OR NO                          01450000
ININDEXD DS    CL1             /*    YES, NO OR NUMBERED                01460000
INKEYRNG DS    CL5                                                      01470000
INRKP    DS    CL3                                                      01480000
INKEYLEN DS    CL3                                                      01490000
INORDERD DS    CL1             /*    YES OR NO                          01500000
INREPLIC DS    CL1             /*    YES OR NO                          01510000
INREUSE  DS    CL1             /*    YES OR NO                          01520000
INSPAN   DS    CL1             /*    YES OR NO                          01530000
INSPEED  DS    CL1             /*    R=RECOVERY                         01540000
INSTAGE  DS    CL1             /*    STAGE, BIND OR CYL FAULT           01550000
         ORG   ,                                                  J51   01560000
P05WSIZ  EQU   *-P05WORK                                          J50   01570000
         SPACE 3                                                        01580000
* ON ENTRY TO THIS ROUTINE R1 POINTS TO NOTHING OF NOTE                 01590000
         SPACE 3                                                        01600000
         JOLSAVE CSECT=UJP05DBF,BASE=(11,12),                          .01610000
               SIZE=P05WSIZ                                       J50   01620000
         USING P05WORK,R13                                        J50   01630000
         MVI   P05FLAG1,P05F1MDL                                  J50   01640000
         SETVAR 'ZLASTCC',12                                            01650006
         SETVAR 'LASTCC',12                                             01651006
         GETTKN 2                                                       01660000
         CLI   TKN,C''''         QUOTED DATA SET NAME?            J52   01661003
         BNE   NDSNQUOT                                           J52   01662003
         DROPQUSR  #TKN                                           J52   01662103
         MVC   #DSN(L'DSN+2),#TKN                                 J52   01662204
         SETVAR 'ZDSN',#DSN AME                                         01662311
         B     P05DSN3         GO FIND DSNAME                     J52   01662411
NDSNQUOT DS    0H                                                       01663003
         CLC   =C'MODEL ',TKN                                     J50   01670000
         BE    P05#10                                             J50   01680000
         XI    P05FLAG1,P05F1MDL                                  J50   01690000
         CLC   =C'DS ',TKN                                        J50   01700000
         BE    P05#10                                             J50   01710000
         CLC   =C'DATASET ',TKN                                   J50   01720000
         BE    P05#10                                             J50   01730000
         JOLERR 300,'INVALID KEYWORD ',#TKN,RC=12                 J50   01740000
P05#10   DS    0H                                                       01750000
         GETTKN 3                                                       01760000
         CLI   TKN,C''''                                                01770000
         BNE   NQUOTED                                                  01780000
         TM    P05FLAG1,P05F1MDL                                  J50   01790000
         BZ    NQUOTED                                                  01800000
         JOLERR 306,'MODEL NAME SHOULD NOT BE IN QUOTES'                01810000
         JOLRETN                                                        01820000
NQUOTED  DS    0H                                                       01830000
*        GETTKN 3                                                       01840000
         MVC   CALLAREA(2),=C'||'                                       01850000
         MVC   TKNCURR,=H'3'                                            01860000
         $CALL UJS60DSN                                                 01870000
         SPACE 3                                                        01880000
* NOW WE MUST FORM UP THE FULL DSNAME.EACH PART IS SEPARATED BY A '.'   01890000
*  OR THERE MAY BE'( )' AFTER                                           01900000
         XC    CALLAREA(2),CALLAREA                                     01910000
         $CALL UJS60DSN        PROCESS DSNAME                           01920000
         B     *+4(R15)                                                 01930000
         B     P05DSN3         STRAIGHT DSNAME                          01940000
         B     P05DSN1         DSNAME + GENERATION NUMBER               01950000
         B     P05DSN1         DSNAME + MEMBER                          01960000
         B     P05DSN1         ERROR IN GENERATION NUMBER               01970000
         B     P05DSN5         INVALID DSNAME                           01980000
P05DSN1  JOLERR 301,'MEMBER NAME AND GENERATION NUMBER NOT ALLOWED WITH.01990000
                ',#WORK,'.',RC=12                                       02000000
P05DSN5  JOLERR 303,'INVALID DATASET NAME',#WORK,'(',MBRNAME,').'       02010000
         JOLRETN                                                        02020000
P05DSN3  DS    0H                                                       02030000
         L     R6,VSAMCBS                                         J50   02040000
         TM    UJFLAG1,UF1DBOPN+UF1DBERR                          J50   02050000
         BNZ   P05XX             OPENED, OR IN ERROR              J50   02060000
         USING VSAMINFO,R6                                        J50   02070000
         VSOPEN (JOLDSDB,INPUT),                                       .02080000
               MF=(E,CALLAREA),NRETURN=P05XX                            02090000
         OI    UJFLAG1,UF1DBERR                                   J50   02100000
         JOLERR 307,'ERROR ',CALLAREA,' OPENING JOL DS DB',RC=16        02110000
P05XX    DS    0H                                                 J50   02120000
         OI    UJFLAG1,UF1DBOPN+UF1DBINP OPEN TO READ             J50   02130000
*        LA    R8,TRANS                                           J50   02140000
         LA    R8,P05DBREC       CVC DEC 89                       J50   02150000
         USING DDDSNDET,R8                                        J50   02160000
         MVC   DDDSNAME,DSN                                       J50   02170000
         VSIO  GETFIRST,JOLDSDB,DDDSNDET,NRETURN=P05FND30               02180000
P05NFND  SETVAR 'ZLASTCC',4                                             02190001
* THE RECORD WASN'T FOUND, BUT WE WANT TO SET UP THE              J50   02200000
* SYMBOLIC VARIABLES ANYWAY.                                      J50   02210000
         MVI   DDOSVB,C' '                                        J50   02220000
         MVC   DDOSVB+1(254),DDOSVB C                             J50   02230000
         MVC   DDOSVB,=AL2(DDLEN)                                 J50   02240000
*        CLEAR C03DEXT,C03DLIKE                                   75128 02250000
         CLEAR DDSPECTP,DDSPECT2,                                 75128*02260000
               DDCANCEL,DDLABEL,DDUNITNO,DDPRIM,DDSEC,DDDIRECT,   80290*02270000
               DDBLKSZE,DDLRECL,DDSIZE,DDSIZE2,DDAVREC,DDBUFNO,   80290*02280000
               DDBUFND,DDBUFNI,                                   82300*02290000
               DDBUFL,DDRKP,DDKEYLEN,DDOVERFL,DDVOLSEQ,DDMAXVOL,  80290*02300000
               DDUNITQU                                                 02310000
*        CLEAR DDAEXTRA,DDLENXTR,DDLENXTR+2,#DDSUBS,#DDVOL,       87150*02320000
               DDSUBS,DDLONGVL                                    87150 02330000
           MVI DDDD1,C'D'                      SET RECORD TYPE TO'D'    02340000
*          MVC DDSTMT,STMT                     MOVE STMT NO IN FOR      02350005
*                                              ERRORS LATER             02360000
           MVC DDLEVEL,LEVEL+1                                          02370000
           MVC DDNEST,NEST+1                                            02380000
           MVC DDOSVB,=AL2(DDLEN)                                       02390000
*          GETTKN NO=2                         GET THE 2ND TOKEN        02400005
*          MVC DDDSID,TKN                      MOVE THE DSIDENTIFIER    02410005
*                                              IN                       02420000
           SPACE 3                                                      02430000
*        JOLERR 310,'D/S ',DDDSNAME,' NOT FOUND IN JOLDSDB',           .02440000
               RC=4                                                     02450000
*        JOLRETN RC=4                                             J50   02460000
         B     SETDSNX                                            J52   02461002
P05FND30 DS    0H                                                 J50   02470000
         CLC   DDDSNAME,DSN      WE ARE SEARCHING GENERICALLY     J52   02471001
         BNE   P05NFND           AND WE DIDN'T GET IT!            J52   02472001
         MVC   #WORK,=H'1'                                        J52   02472108
         MVI   WORK,C'0'                                          J52   02472208
         SETVAR 'ZLASTCC',#WORK                                   J52   02472308
         SETVAR 'LASTCC',#WORK                                    J52   02472408
SETDSNX  DS    0H                                                 J52   02473002
         MVC   P05MODEL,DDDSID   BLANKS OR 12 CHARACTER MODEL NAME 50   02490000
         SETVAR 'ZMODEL',P05MODEL                                 J50   02500000
         SETVAR 'ZOWNER',DDDDNAME                                 J52   02510000
*        MVC   #TKN(2),=AL2(L'TKN)                                J50   02520005
         MVC   #TKN(2),ZERO                                       J52   02521005
         CLEAR TKN                                                J50   02530000
         CLC   DDOSVB,=AL2(DDLEN)                        JOL30047 J52   02531010
         BNH   P05NVSP        NO VSAM DATA                        J52   02532010
*        CLC   DDOSVB,=H'300'                                     J50   02540010
*        BL    P05NVSP                                            J50   02550010
         MVC   #TKN(256),#DDVSAML                                 J50   02560009
P05NVSP  DS    0H                                                 J50   02570000
* UNPACK VSAM STUFF (FIELDS MAY BE BLANK, BUT THAT IS OK)         J50   02580000
         SETVAR 'ZVSAMTXT',#TKN                                         02590000
         SETVAR 'ZMBR',DDMBR                                            02600000
         SETVAR 'ZTYPE',DDTYPE                                          02620000
         TM    DDCANCEL,DDNOVOL                                   J50   02630000
         BO    P05#110                                            J50   02640000
         SETVAR 'ZNOVOL',=C'N'                                          02650000
         B     P05#120                                            J50   02660000
P05#110  DS    0H                                                       02670000
         SETVAR 'ZNOVOL',=C'Y'                                          02680000
P05#120  DS    0H                                                       02690000
         TM    DDCANCEL,DDNODCB                                   J50   02700000
         BO    P05#210                                            J50   02710000
         SETVAR 'ZNODCB',=C'N'                                          02720000
         B     P05#220                                            J50   02730000
P05#210  DS    0H                                                       02740000
         SETVAR 'ZNODCB',=C'Y'                                          02750000
P05#220  DS    0H                                                       02760000
         TM    DDCANCEL,DDNOUNI                                   J50   02770000
         BO    P05#310                                            J50   02780000
         SETVAR 'ZNOUNIT',=C'N'                                         02790000
         B     P05#320                                            J50   02800000
P05#310  DS    0H                                                       02810000
         SETVAR 'ZNOUNIT',=C'Y'                                         02820000
P05#320  DS    0H                                                       02830000
         TM    DDUNITQU,DDUNITQ                                   J50   02840000
         BO    P05#330                                            J50   02850000
         SETVAR 'ZQUEUE',=C'N'                                          02860000
         B     P05#340                                            J50   02870000
P05#330  DS    0H                                                       02880000
         SETVAR 'ZQUEUE',=C'Y'                                          02890000
P05#340  DS    0H                                                       02900000
         SETVAR 'ZLABTYP',DDLABTYP                                      02910000
         SETVAR 'ZVOLUMES',DDVOLUME                                     02920000
         SETVAR 'ZFILENO',DDLABEL                                       02930000
         SETVAR 'ZUNIT',DDUNIT                                          02940000
         SETVAR 'ZUNITCT',DDUNITNO                                      02950000
         SETVAR 'ZPRIM',DDPRIM                                          02960000
         SETVAR 'ZSEC',DDSEC                                            02970000
         SETVAR 'ZDIR',DDDIRECT                                         02980000
         SETVAR 'ZSPACETP',DDCYLTRK                                     02990000
         TM    DDSPECTP,X'01'                                     J50   03000000
         BO    P05#350                                            J50   03010000
         SETVAR 'ZROUND',=C'N'                                          03020000
         B     P05#360                                            J50   03030000
P05#350  DS    0H                                                       03040000
         SETVAR 'ZROUND',=C'Y'                                          03050000
P05#360  DS    0H                                                       03060000
         TM    DDSPECTP,X'02'                                     J50   03070000
         BO    P05#370                                            J50   03080000
         SETVAR 'ZALX',=C'N'                                            03090000
         B     P05#380                                            J50   03100000
P05#370  DS    0H                                                       03110000
         SETVAR 'ZALX',=C'Y'                                            03120000
P05#380  DS    0H                                                       03130000
         TM    DDSPECTP,X'04'                                     J50   03140000
         BO    P05#390                                            J50   03150000
         SETVAR 'ZMAXIG',=C'N'                                          03160000
         B     P05#3A0                                            J50   03170000
P05#390  DS    0H                                                       03180000
         SETVAR 'ZMAXIG',=C'Y'                                          03190000
P05#3A0  DS    0H                                                       03200000
         SETVAR 'ZPROTECT',=C'N'                                  J52   03210000
         TM    DDSPECTP,X'20'                                     J52   03220000
         BZ    P05#3A1                                            J52   03230000
         SETVAR 'ZPROTECT',=C'Y'                                  J52   03240000
P05#3A1  DS    0H                                                 J52   03250000
         SETVAR 'ZRECFM',DDRECFM                                        03260000
         SETVAR 'ZLRECL',DDLRECL                                        03270000
         SETVAR 'ZBLKSIZE',DDBLKSZE                                     03280000
         SETVAR 'ZAVREC',DDAVREC                                        03290000
         SETVAR 'ZBUFNO',DDBUFNO                                        03300000
         SETVAR 'ZBUFL',DDBUFL                                          03310000
         SETVAR 'ZBUFNI',DDBUFNI                                        03320000
         SETVAR 'ZBUFND',DDBUFND                                        03330000
         SETVAR 'ZLIMCT',DDLIMCT                                        03340000
         SETVAR 'ZOPTCD',DDOPTCD                                        03350000
         SETVAR 'ZDEN',DDDENS                                           03360000
         SETVAR 'ZRKP',DDRKP                                            03370000
         SETVAR 'ZKEYLEN',DDKEYLEN                                      03380000
         SETVAR 'ZOVERFL',DDOVERFL                                      03390000
         SETVAR 'ZDSORG',DDDSORG                                        03400000
         TM    DDSPECT2,X'01'                                     J50   03410000
         BZ    P05#3B0                                            J50   03420000
         SETVAR 'ZDSORG',=C'VSAM'                                       03430000
P05#3B0  DS    0H                                                       03440000
         SETVAR 'ZRLSE',=C'Y'                                     J52   03450000
         TM    DDSPECT2,X'02'                                     J52   03460000
         BZ    P05#3B1                                            J52   03470000
         SETVAR 'ZRLSE',=C'N'                                     J52   03480000
P05#3B1  DS    0H                                                 J52   03490000
         SETVAR 'ZCONTIG',=C'N'                                   J52   03500000
         TM    DDSPECT2,X'80'                                     J52   03510000
         BZ    P05#3B2                                            J52   03520000
         SETVAR 'ZCONTIG',=C'Y'                                   J52   03530000
P05#3B2  DS    0H                                                 J52   03540000
         SETVAR 'ZRETPD',DDRETPD                                        03550000
         SETVAR 'ZEXPDT',DDEXPDT                                        03560000
         SETVAR 'ZVOLSEQ',DDVOLSEQ                                      03570000
         SETVAR 'ZMAXVOL',DDMAXVOL                                      03580000
         SETVAR 'ZCODE',DDCODE                                          03590000
         SETVAR 'ZFUNC',DDFUNC                                          03600000
         CLC   DDOSVB,=AL2(DDLEN)  LONGER THAN USUAL ?            J52   03601005
         BH    C03LEXTR            YES,LEAVE EXTRA                J52   03602005
*        MVC   DDOSVB,=AL2(DDLEN) SET RECORD LENGTH TO EXCLUDE IT J52   03603005
         MVC   DDEXTRA,BLANKS      JUST FOR SAFETY!               J52   03604005
C03LEXTR EQU   *                                                  J52   03605005
         SETVAR 'ZEXTRA',DDEXTRA                                        03610000
         CLI   DDTYPE,DDPUNCH                                     J52   03620000
         BNH   P05PRNT                                            J52   03630000
         SETVAR 'ZSYSCLS',=C' '                                   J52   03640000
         SETVAR 'ZSYSFOR',=C' '                                   J52   03650000
         SETVAR 'ZOUTLIM',=C' '                                   J52   03660000
         SETVAR 'ZSYSPGM',=C' '                                   J52   03670000
         SETVAR 'ZSYSUCS',=C' '                                   J52   03680000
         SETVAR 'ZSYSCHAR',=C' '                                  J52   03690000
         SETVAR 'ZCOPIES',=C' '                                   J52   03700000
         SETVAR 'ZSYSROUT',=C' '                                  J52   03710000
         SETVAR 'ZSYSFCB',=C' '                                   J52   03720000
         SETVAR 'ZSYSFLAS',=C' '                                  J52   03730000
         SETVAR 'ZSYSMOD',=C' '                                   J52   03740000
         SETVAR 'ZSYSBURS',=C' '                                  J52   03750000
         JOLRETN RC=0                                             J52   03760000
P05PRNT  DS    0H                                                 J52   03770000
         SETVAR 'ZSYSCLS',DDSYSCLS                                J52   03780000
         SETVAR 'ZSYSFOR',DDSYSFRM                                J52   03790000
         SETVAR 'ZOUTLIM',DDOUTLIM                                J52   03800000
         SETVAR 'ZSYSPGM',DDSYSPGM                                J52   03810000
         SETVAR 'ZSYSUCS',DDUCS                                   J52   03820000
         SETVAR 'ZSYSCHAR',DDCHAR                                 J52   03830000
         SETVAR 'ZCOPIES',DDCOPIES                                J52   03840000
         SETVAR 'ZSYSROUT',DDROUTE                                J52   03850000
         SETVAR 'ZSYSFCB',DDFCB                                   J52   03860000
         SETVAR 'ZSYSFLAS',DDFLASH                                J52   03870000
         SETVAR 'ZSYSMOD',DDMODIFY                                J52   03880000
         SETVAR 'ZSYSBURS',DDBURST                                J52   03890000
         JOLRETN RC=0                                             J52   03900000
         AGO    .SKIPVSM                                          J51   03910000
         SETVAR 'ZCLFREEI',CLFREECI                                     03920000
         SETVAR 'ZCLFREEA',CLFREECA                                     03930000
         SETVAR 'ZCLUNIQU',CLUNIQUE         UNIQUE SPACE                03940000
*                                                                       03950000
*CLPASSRD DS    CL8             /* PASSWORD (READ)                      03960000
*CLPASSWR DS    CL8             /* PASSWORD (WRITE)                     03970000
         SETVAR 'ZCLATTEM',CLATTEMP         ATTEMPTS                    03980000
*                                                                       03990000
*CLRETPD  DS    CL1                                                     04000000
*CLEXPDT  DS    CL5                                                     04010000
*                                                                       04020000
*CLBUFFSP DS    CL1             /*    BUFFER SPACE                      04030000
         SETVAR  'ZCLCODE',CLCODE                                       04040000
         SETVAR  'ZCLWAIT',CLWAIT          /*    STAGE WAIT             04050000
         SETVAR  'ZCLERASE',CLERASE         /*    YES OR NO             04060000
         SETVAR  'ZCLIMBED',CLIMBED         /*    YES OR NO             04070000
         SETVAR  'ZCLINDEX',CLINDEXD       /*    YES, NO OR NUMBER      04080000
         SETVAR  'ZCLKEYRG',CLKEYRNG                                    04090000
*CLRKP                                                                  04100000
*CLKEYLEN                                                               04110000
         SETVAR  'ZCLORDER',CLORDERD            /*    YES OR NO         04120000
         SETVAR  'ZCLREPL',CLREPLIC           /*    YES OR NO           04130000
         SETVAR  'ZCLREUSE',CLREUSE           /*    YES OR NO           04140000
         SETVAR  'ZCLSPAN',CLSPAN             /*    YES OR NO           04150000
         SETVAR  'ZCLSPEED',CLSPEED           /*    R=RECOVERY          04160000
         SETVAR  'ZCLSTAGE',CLSTAGE            /*    STAGE, BIND OR CY  04170000
*                                                                       04180000
*                                                                       04190000
* VSAM DATA DETAILS                                                     04200000
*                                                                       04210000
*                                                                       04220000
* START OF NEW SECTION .... VSAM DATA SECTION ........                  04230000
*                                                                       04240000
         SETVAR  'ZDTNAME',DTNAME              /* DATA NAME             04250000
*                                                                       04260000
         SETVAR  'ZDTVOL',DTVOLUME            /* ENOUGH FOR 6 VOLS      04270000
*                                                                       04280000
         SETVAR  'ZDTPRIM',DTPRIM   DS    CL5                           04290000
         SETVAR  'ZDTSEC',DTSEC    DS    CL5                            04300000
         SETVAR  'ZDTCSIZE',DTCISIZE DS    CL5                          04310000
*DTNORLSE DS    CL1             /*    NORLSE                            04320000
         SETVAR  'ZDTCYLTR',DTCYLTRK            /* CYL TRK OR REC       04330000
         SETVAR  'ZDTFREEI',DTFREECI            /* %                    04340000
         SETVAR  'ZDTFREEA',DTFREECA            /* % OR 0               04350000
         SETVAR  'ZDTUNIQU',DTUNIQUE            /*    UNIQUE SPACE      04360000
*                                                                       04370000
*DTPASSRD DS    CL8             /* PASSWORD (READ)                      04380000
*DTPASSWR DS    CL8             /* PASSWORD (WRITE)                     04390000
         SETVAR  'ZDTATTEM',DTATTEMP             /* ATTEMPTS            04400000
*                                                                       04410000
         SETVAR  'ZDTRETPD',DTRETPD                                     04420000
         SETVAR  'ZDTEXPDT',DTEXPDT                                     04430000
*                                                                       04440000
         SETVAR  'ZDTBUFSP',DTBUFFSP            /*    BUFFER SPACE      04450000
         SETVAR  'ZDTCODE',DTCODE                                       04460000
         SETVAR  'ZDTWAIT',DTWAIT              /*    STAGE WAIT         04470000
         SETVAR  'ZDTERASE',DTERASE             /*    YES OR NO         04480000
         SETVAR  'ZDTIMBED',DTIMBED             /*    YES OR NO         04490000
         SETVAR  'ZDTINDEX',DTINDEXD           /*    YES, NO OR NUMBER  04500000
         SETVAR  'ZDTKEYRG',DTKEYRNG                                    04510000
         SETVAR  'ZDTRKP',DTRKP                                         04520000
         SETVAR  'ZDTKEYLN',DTKEYLEN                                    04530000
         SETVAR  'ZDTORDER',DTORDERD           /*    YES OR NO          04540000
         SETVAR  'ZDTREPL',DTREPLIC           /*    YES OR NO           04550000
         SETVAR  'ZDTREUSE',DTREUSE            /*    YES OR NO          04560000
         SETVAR  'ZDTSPAN',DTSPAN             /*    YES OR NO           04570000
         SETVAR  'ZDTSPEED',DTSPEED            /*    R=RECOVERY         04580000
         SETVAR  'ZDTSTAGE',DTSTAGE            /*    STAGE, BIND OR CY  04590000
*                                                                       04600000
*                                                                       04610000
* VSAM INDEX DETAILS                                                    04620000
*                                                                       04630000
*                                                                       04640000
* START OF NEW SECTION                                                  04650000
*                                                                       04660000
         SETVAR  'ZINNAME',INNAME          /* CLUSTER DATA SET NAME.    04670000
         SETVAR  'ZINVOL',INVOLUME         /* ENOUGH FOR 6 VOLS         04680000
*                                                                       04690000
         SETVAR  'ZINPRIM',INPRIM   CL5                                 04700000
         SETVAR  'ZINSEC',INSEC    CL5                                  04710000
         SETVAR  'ZINCSIZE',INCISIZE CL5                                04720000
*         SETVAR  INNORLSE CL1       /*    NORLSE                       04730000
         SETVAR  'ZINCYLTR',INCYLTRK CL1       /* CYL TRK OR REC        04740000
         SETVAR  'ZINFREEI',INFREECI CL2      /* %                      04750000
         SETVAR  'ZINFREEA',INFREECA CL2      * % OR 0                  04760000
         SETVAR  'ZINUNIQU',INUNIQUE CL1      /*    UNIQUE SPACE        04770000
*                                                                       04780000
*INPASSRD CL8     /* PASSWORD (READ)                                    04790000
*INPASSWR CL8     /* PASSWORD (WRITE)                                   04800000
         SETVAR  'ZINATTEM',INATTEMP CL1      /* ATTEMPTS               04810000
*                                                                       04820000
*INRETPD  CL1                                                           04830000
*INEXPDT  CL5                                                           04840000
*                                                                       04850000
         SETVAR  'ZINBUFSP',INBUFFSP CL1      /*    BUFFER SPACE        04860000
         SETVAR  'ZINCODE',INCODE   CL1                                 04870000
         SETVAR  'ZINWAIT',INWAIT   CL1       /*    STAGE WAIT          04880000
         SETVAR  'ZINERASE',INERASE  CL1      /*    YES OR NO           04890000
         SETVAR  'ZINIMBED',INIMBED  CL1       /*    YES OR NO          04900000
         SETVAR  'ZININDEX',ININDEXD CL1       /*    YES, NO OR NUMBER  04910000
         SETVAR  'ZINKEYRG',INKEYRNG CL5                                04920000
         SETVAR  'ZINRKP',INRKP    CL3                                  04930000
         SETVAR  'ZINKEYLN',INKEYLEN CL3                                04940000
         SETVAR  'ZINORDER',INORDERD CL1       /*    YES OR NO          04950000
         SETVAR  'ZINREPLI',INREPLIC CL1       /*    YES OR NO          04960000
         SETVAR  'ZINREUSE',INREUSE  CL1       /*    YES OR NO          04970000
         SETVAR  'ZINSPAN',INSPAN   CL1       /*    YES OR NO           04980000
         SETVAR  'ZINSPEED',INSPEED  CL1       /*    R=RECOVERY         04990000
         SETVAR  'ZINSTAGE',INSTAGE  CL1      /*    STAGE, BIND OR CY   05000000
.SKIPVSM  ANOP                                                    J51   05010000
         JOLRETN                                                        05020000
HEX      EQU *-240                                                      05030000
         DC    C'0123456789ABCDEF'                                      05040000
         DC    60S(*)                                                   05050000
         DS    0D                                                       05060000
         END                                                            05070000
